if(Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),n=this,i=function(){},r=function(){return n.apply(this instanceof i&&t?this:t,e.concat(Array.prototype.slice.call(arguments)))};return i.prototype=this.prototype,r.prototype=new i,r}),Array.prototype.forEach||(Array.prototype.forEach=function(t,e){for(var n=0,i=this.length;i>n;++n)t.call(e,this[n],n,this)}),Array.prototype.filter||(Array.prototype.filter=function(t){"use strict";if(void 0===this||null===this)throw new TypeError;var e=Object(this),n=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var i=[],r=arguments.length>=2?arguments[1]:void 0,s=0;n>s;s++)if(s in e){var o=e[s];t.call(r,o,s,e)&&i.push(o)}return i}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t,e){if(void 0===this||null===this)throw new TypeError('"this" is null or not defined');var n=this.length>>>0;for(e=+e||0,1/0===Math.abs(e)&&(e=0),0>e&&(e+=n,0>e&&(e=0));n>e;e++)if(this[e]===t)return e;return-1}),Element&&!Element.prototype.matches){var proto=Element.prototype;proto.matches=proto.matchesSelector||proto.mozMatchesSelector||proto.msMatchesSelector||proto.oMatchesSelector||proto.webkitMatchesSelector||function(t){return Array.prototype.indexOf.call(document.documentElement.querySelectorAll(t),this)>-1}}"undefined"==typeof document||"classList"in document.createElement("a")||!function(t){"use strict";if("HTMLElement"in t||"Element"in t){var e="classList",n="prototype",i=(t.HTMLElement||t.Element)[n],r=Object,s=String[n].trim||function(){return this.replace(/^\s+|\s+$/g,"")},o=Array[n].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},a=function(t,e){this.name=t,this.code=DOMException[t],this.message=e},u=function(t,e){if(""===e)throw new a("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(e))throw new a("INVALID_CHARACTER_ERR","String contains an invalid character");return o.call(t,e)},c=function(t){for(var e=s.call(t.className),n=e?e.split(/\s+/):[],i=0,r=n.length;r>i;i++)this.push(n[i]);this._updateClassName=function(){t.className=this.toString()}},l=c[n]=[],h=function(){return new c(this)};if(a[n]=Error[n],l.item=function(t){return this[t]||null},l.contains=function(t){return t+="",-1!==u(this,t)},l.add=function(){var t,e=arguments,n=0,i=e.length,r=!1;do t=e[n]+"",-1===u(this,t)&&(this.push(t),r=!0);while(++n<i);r&&this._updateClassName()},l.remove=function(){var t,e=arguments,n=0,i=e.length,r=!1;do{t=e[n]+"";var s=u(this,t);-1!==s&&(this.splice(s,1),r=!0)}while(++n<i);r&&this._updateClassName()},l.toggle=function(t,e){t+="";var n=this.contains(t),i=n?e!==!0&&"remove":e!==!1&&"add";return i&&this[i](t),!n},l.toString=function(){return this.join(" ")},r.defineProperty){var p={get:h,enumerable:!0,configurable:!0};try{r.defineProperty(i,e,p)}catch(f){-2146823252===f.number&&(p.enumerable=!1,r.defineProperty(i,e,p))}}else r[n].__defineGetter__&&i.__defineGetter__(e,h)}}(self),!function(){var t,e,n,i;!function(){var r={},s={};t=function(t,e,n){r[t]={deps:e,callback:n}},i=n=e=function(t){function n(e){if("."!==e.charAt(0))return e;for(var n=e.split("/"),i=t.split("/").slice(0,-1),r=0,s=n.length;s>r;r++){var o=n[r];if(".."===o)i.pop();else{if("."===o)continue;i.push(o)}}return i.join("/")}if(i._eak_seen=r,s[t])return s[t];if(s[t]={},!r[t])throw new Error("Could not find module "+t);for(var o,a=r[t],u=a.deps,c=a.callback,l=[],h=0,p=u.length;p>h;h++)l.push("exports"===u[h]?o={}:e(n(u[h])));var f=c.apply(this,l);return s[t]=o||f}}(),t("promise/all",["./utils","exports"],function(t,e){"use strict";function n(t){var e=this;if(!i(t))throw new TypeError("You must pass an array to all.");return new e(function(e,n){function i(t){return function(e){s(t,e)}}function s(t,n){a[t]=n,0===--u&&e(a)}var o,a=[],u=t.length;0===u&&e([]);for(var c=0;c<t.length;c++)o=t[c],o&&r(o.then)?o.then(i(c),n):s(c,o)})}var i=t.isArray,r=t.isFunction;e.all=n}),t("promise/asap",["exports"],function(t){"use strict";function e(){return function(){process.nextTick(r)}}function n(){var t=0,e=new u(r),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function i(){return function(){c.setTimeout(r,1)}}function r(){for(var t=0;t<l.length;t++){var e=l[t],n=e[0],i=e[1];n(i)}l=[]}function s(t,e){var n=l.push([t,e]);1===n&&o()}var o,a="undefined"!=typeof window?window:{},u=a.MutationObserver||a.WebKitMutationObserver,c="undefined"!=typeof global?global:this,l=[];o="undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?e():u?n():i(),t.asap=s}),t("promise/cast",["exports"],function(t){"use strict";function e(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=this;return new e(function(e){e(t)})}t.cast=e}),t("promise/config",["exports"],function(t){"use strict";function e(t,e){return 2!==arguments.length?n[t]:void(n[t]=e)}var n={instrument:!1};t.config=n,t.configure=e}),t("promise/polyfill",["./promise","./utils","exports"],function(t,e,n){"use strict";function i(){var t="Promise"in window&&"cast"in window.Promise&&"resolve"in window.Promise&&"reject"in window.Promise&&"all"in window.Promise&&"race"in window.Promise&&function(){var t;return new window.Promise(function(e){t=e}),s(t)}();t||(window.Promise=r)}var r=t.Promise,s=e.isFunction;n.polyfill=i}),t("promise/promise",["./config","./utils","./cast","./all","./race","./resolve","./reject","./asap","exports"],function(t,e,n,i,r,s,o,a,u){"use strict";function c(t){if(!E(t))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof c))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._subscribers=[],l(t,this)}function l(t,e){function n(t){_(e,t)}function i(t){v(e,t)}try{t(n,i)}catch(r){i(r)}}function h(t,e,n,i){var r,s,o,a,u=E(n);if(u)try{r=n(i),o=!0}catch(c){a=!0,s=c}else r=i,o=!0;d(e,r)||(u&&o?_(e,r):a?v(e,s):t===P?_(e,r):t===I&&v(e,r))}function p(t,e,n,i){var r=t._subscribers,s=r.length;r[s]=e,r[s+P]=n,r[s+I]=i}function f(t,e){for(var n,i,r=t._subscribers,s=t._detail,o=0;o<r.length;o+=3)n=r[o],i=r[o+e],h(e,n,i,s);t._subscribers=null}function d(t,e){var n,i=null;try{if(t===e)throw new TypeError("A promises callback cannot return that same promise.");if(w(e)&&(i=e.then,E(i)))return i.call(e,function(i){return n?!0:(n=!0,void(e!==i?_(t,i):y(t,i)))},function(e){return n?!0:(n=!0,void v(t,e))}),!0}catch(r){return n?!0:(v(t,r),!0)}return!1}function _(t,e){t===e?y(t,e):d(t,e)||y(t,e)}function y(t,e){t._state===O&&(t._state=S,t._detail=e,b.async(g,t))}function v(t,e){t._state===O&&(t._state=S,t._detail=e,b.async(m,t))}function g(t){f(t,t._state=P)}function m(t){f(t,t._state=I)}var b=t.config,w=(t.configure,e.objectOrFunction),E=e.isFunction,x=(e.now,n.cast),F=i.all,N=r.race,C=s.resolve,T=o.reject,k=a.asap;b.async=k;var O=void 0,S=0,P=1,I=2;c.prototype={constructor:c,_state:void 0,_detail:void 0,_subscribers:void 0,then:function(t,e){var n=this,i=new this.constructor(function(){});if(this._state){var r=arguments;b.async(function(){h(n._state,i,r[n._state-1],n._detail)})}else p(this,i,t,e);return i},"catch":function(t){return this.then(null,t)}},c.all=F,c.cast=x,c.race=N,c.resolve=C,c.reject=T,u.Promise=c}),t("promise/race",["./utils","exports"],function(t,e){"use strict";function n(t){var e=this;if(!i(t))throw new TypeError("You must pass an array to race.");return new e(function(e,n){for(var i,r=0;r<t.length;r++)i=t[r],i&&"function"==typeof i.then?i.then(e,n):e(i)})}var i=t.isArray;e.race=n}),t("promise/reject",["exports"],function(t){"use strict";function e(t){var e=this;return new e(function(e,n){n(t)})}t.reject=e}),t("promise/resolve",["exports"],function(t){"use strict";function e(t){var e=this;return new e(function(e){e(t)})}t.resolve=e}),t("promise/utils",["exports"],function(t){"use strict";function e(t){return n(t)||"object"==typeof t&&null!==t}function n(t){return"function"==typeof t}function i(t){return"[object Array]"===Object.prototype.toString.call(t)}var r=Date.now||function(){return(new Date).getTime()};t.objectOrFunction=e,t.isFunction=n,t.isArray=i,t.now=r}),e("promise/polyfill").polyfill()}(),function(){this.Skim={access:function(t){var e;return e=this[t],"function"==typeof e&&(e=e.call(this)),e===!0?[this]:e===!1||null==e?!1:"[object Array]"!==Object.prototype.toString.call(e)?[e]:0===e.length?!1:e},withContext:function(t,e){var n,i;return n=function(t){var e;return e=function(){},e.prototype=t,new e},t=n(t),t.safe||(t.safe=this.safe||function(t){var e;return(null!=t?t.skimSafe:void 0)?t:(e=new String(null!=t?t:""),e.skimSafe=!0,e)}),t.isArray=Array.isArray||function(t){return"[object Array]"==={}.toString.call(t)},t.flatten=i=function(t){var e,n,r,s;for(n=[],r=0,s=t.length;s>r;r++)e=t[r],e instanceof Array?n=n.concat(i(e)):n.push(e);return n},t.escape||(t.escape=this.escape||function(t){return null==t?"":t.skimSafe||!/[&<>\"]/.test(t)?t:this.safe(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),e.call(t)}}}.call(this);var __indexOf=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},__slice=[].slice,__hasProp={}.hasOwnProperty;!function(t){"use strict";var e,n,i,r,s,o;e=t.pi=t.pi||{},n=/\b[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}\b/i,i=/^<.+>$/m,o=100,r=function(t,e,n,i){return t[n]===e[n]?0:!t[n]||t[n]<e[n]?1+-2*i:-(1+-2*i)},s=function(t,e,n,i){var s,o,a,u,c,l;for(a=0,u=function(n,s){var o;return o=r(t,e,n,"object"==typeof i?i[s]:i),0===a?a=o:void 0},s=c=0,l=n.length;l>c;s=++c)o=n[s],u(o,s);return a},e.utils={uuid:function(){return""+ ++o},escapeRegexp:function(t){return t.replace(/[-[\]{}()*+?.,\\^$|#]/g,"\\$&")},is_email:function(t){return n.test(t)},is_html:function(t){return i.test(t)},camelCase:function(t){var n;return t+="",t.length?function(){var i,r,s,o;for(s=t.split("_"),o=[],i=0,r=s.length;r>i;i++)n=s[i],o.push(e.utils.capitalize(n));return o}().join(""):t},snake_case:function(t){var e,n;return t+="",t.length?(e=t.match(/((?:^[^A-Z]|[A-Z])[^A-Z]*)/g),function(){var t,i,r;for(r=[],t=0,i=e.length;i>t;t++)n=e[t],r.push(n.toLowerCase());return r}().join("_")):t},capitalize:function(t){return t[0].toUpperCase()+t.slice(1)},serialize:function(t){return t=function(){switch(!1){case!(null==t):return null;case"true"!==t:return!0;case"false"!==t:return!1;case!isNaN(Number(t)):return t;default:return Number(t)}}()},clone:function(t,n){var i,r,s;if(null==n&&(n=[]),null==t||"object"!=typeof t)return t;if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp)return i="",null!=t.global&&(i+="g"),null!=t.ignoreCase&&(i+="i"),null!=t.multiline&&(i+="m"),null!=t.sticky&&(i+="y"),new RegExp(t.source,i);if(t instanceof Element)return t.cloneNode(!0);s=new t.constructor;for(r in t)__indexOf.call(n,r)<0&&(s[r]=e.utils.clone(t[r]));return s},sort:function(t,e,n){return null==n&&(n=!1),t.sort(curry(s,[e,n],null,!0))},sort_by:function(t,e,n){return null==n&&(n=!1),t.sort(curry(r,[e,n],null,!0))},debounce:function(t,n,i){var r,s;return null==i&&(i=null),s=!1,r=null,function(){var o;return o=1<=arguments.length?__slice.call(arguments,0):[],s?void(r=o):(e.utils.after(t,function(){return s=!1,null!=r?n.apply(i,r):void 0}),s=!0,null==r?n.apply(i,o):void 0)}},curry:function(t,e,n,i){return null==e&&(e=[]),null==n&&(n=this),null==i&&(i=!1),t="function"==typeof t?t:n[t],e=e instanceof Array?e:[e],function(){var r;return r=1<=arguments.length?__slice.call(arguments,0):[],t.apply(n,i?r.concat(e):e.concat(r))}},delayed:function(t,n,i,r){return null==i&&(i=[]),null==r&&(r=this),function(){return setTimeout(e.utils.curry(n,i,r),t)}},after:function(t,e,n){return delayed(t,e,[],n)()},merge:function(t,n){var i,r,s;r=e.utils.clone(t);for(i in n)__hasProp.call(n,i)&&(s=n[i],r[i]=s);return r},extend:function(t,e){var n,i;for(n in e)__hasProp.call(e,n)&&(i=e[n],null==t[n]&&(t[n]=i));return t}}}(this),function(t){"use strict";var e,n,i,r;return e=t.pi=t.pi||{},n=e.utils,e.Event=function(){function t(t){null!=t&&"object"==typeof t?n.extend(this,t):this.type=t,this.canceled=!1}return t.prototype.cancel=function(){return this.canceled=!0},t}(),i=function(){return!0},e.EventListener=function(){function t(t,e,r,s,o){this.type=t,this.handler=e,this.context=null!=r?r:null,this.disposable=null!=s?s:!1,this.conditions=o,null==this.handler._uuid&&(this.handler._uuid="fun"+n.uuid()),this.uuid=""+this.type+":"+this.handler._uuid,"function"!=typeof this.conditions&&(this.conditions=i),null!=this.context&&(null==this.context._uuid&&(this.context._uuid="obj"+n.uuid()),this.uuid+=":"+this.context._uuid)}return t.prototype.dispatch=function(t){return!this.disposed&&this.conditions(t)?(this.handler.call(this.context,t),this.disposable?this.dispose():void 0):void 0},t.prototype.dispose=function(){return this.handler=this.context=this.conditions=null,this.disposed=!0},t}(),r=function(t){return"string"==typeof t?t.split(","):Array.isArray(t)?t:[null]},e.EventDispatcher=function(){function t(){this.listeners={},this.listeners_by_key={}}return t.prototype.on=function(t,n,i,s){var o,a,u,c,l;for(c=r(t),l=[],a=0,u=c.length;u>a;a++)o=c[a],l.push(this.add_listener(new e.EventListener(o,n,i,!1,s)));return l},t.prototype.one=function(t,n,i,r){return this.add_listener(new e.EventListener(t,n,i,!0,r))},t.prototype.off=function(t,e,n,i){var s,o,a,u,c;for(u=r(t),c=[],o=0,a=u.length;a>o;o++)s=u[o],c.push(this.remove_listener(s,e,n,i));return c},t.prototype.trigger=function(t,i){var r,s,o,a;if(t instanceof e.Event||(t=new e.Event(t)),null!=i&&(t.data=i),t.currentTarget=this,null!=this.listeners[t.type]){for(n.debug("Event: "+t.type,t),a=this.listeners[t.type],s=0,o=a.length;o>s&&(r=a[s],r.dispatch(t),t.canceled!==!0);s++);this.remove_disposed_listeners()}},t.prototype.add_listener=function(t){var e,n;return(e=this.listeners)[n=t.type]||(e[n]=[]),this.listeners[t.type].push(t),this.listeners_by_key[t.uuid]=t},t.prototype.remove_listener=function(t,e,n,i){var r,s,o,a,u;if(null==n&&(n=null),null==i&&(i=null),null==t)return this.remove_all();if(null!=this.listeners[t]){if(null==e){for(u=this.listeners[t],o=0,a=u.length;a>o;o++)r=u[o],r.dispose();return this.remove_type(t),void this.remove_disposed_listeners()}s=""+t+":"+e._uuid,null!=n&&(s+=":"+n._uuid),r=this.listeners_by_key[s],null!=r&&(delete this.listeners_by_key[s],this.remove_listener_from_list(t,r))}},t.prototype.remove_listener_from_list=function(t,e){return null!=this.listeners[t]&&this.listeners[t].indexOf(e)>-1&&(this.listeners[t]=this.listeners[t].filter(function(t){return t!==e}),!this.listeners[t].length)?this.remove_type(t):void 0},t.prototype.remove_disposed_listeners=function(){var t,e,n,i;n=this.listeners_by_key,i=[];for(t in n)e=n[t],e.disposed?(this.remove_listener_from_list(e.type,e),i.push(delete this.listeners_by_key[t])):i.push(void 0);return i},t.prototype.remove_type=function(t){return delete this.listeners[t]},t.prototype.remove_all=function(){return this.listeners={},this.listeners_by_key={}},t}()}(this);var __hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var i in e)__hasProp.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};!function(t){"use strict";var e,n,i,r,s,o,a,u;return i=t.pi=t.pi||{},r=i.utils,e=i.Events||{},i.NodEvent=function(t){function e(t){this.event=t||window.event,this.origTarget=this.event.target||this.event.srcElement,this.target=i.Nod.create(this.origTarget),this.type=this.constructor.is_aliased[t.type]?this.constructor.reversed_aliases[t.type]:t.type,this.ctrlKey=this.event.ctrlKey,this.shiftKey=this.event.shiftKey,this.altKey=this.event.altKey,this.metaKey=this.event.metaKey,this.detail=this.event.detail}return __extends(e,t),e.aliases={},e.reversed_aliases={},e.delegates={},e.add=function(){return"undefined"==typeof Element.prototype.addEventListener?function(t,e,n){return t.attachEvent("on"+e,n)}:function(t,e,n){return t.addEventListener(e,n)}}(),e.remove=function(){return"undefined"==typeof Element.prototype.removeEventListener?function(t,e,n){return t.detachEvent("on"+e,n)}:function(t,e,n){return t.removeEventListener(e,n)}}(),e.register_delegate=function(t,e){return this.delegates[t]=e},e.has_delegate=function(t){return!!this.delegates[t]},e.register_alias=function(t,e){return this.aliases[t]=e,this.reversed_aliases[e]=t},e.has_alias=function(t){return!!this.aliases[t]},e.is_aliased=function(t){return!!this.reversed_aliases[t]},e.prototype.stopPropagation=function(){return this.event.stopPropagation?this.event.stopPropagation():this.event.cancelBubble=!0},e.prototype.stopImmediatePropagation=function(){return this.event.stopImmediatePropagation?this.event.stopImmediatePropagation():(this.event.cancelBubble=!0,this.event.cancel=!0)},e.prototype.preventDefault=function(){return this.event.preventDefault?this.event.preventDefault():this.event.returnValue=!1},e.prototype.cancel=function(){return this.stopImmediatePropagation(),this.preventDefault(),e.__super__.cancel.apply(this,arguments)},e}(i.Event),n=i.NodEvent,s=/(click|mouse|contextmenu)/i,i.MouseEvent=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.button=this.event.button,null==this.pageX&&(this.pageX=this.event.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,this.pageY=this.event.clientY+document.body.scrollTop+document.documentElement.scrollTop),null==this.offsetX&&(this.offsetX=this.event.layerX-this.origTarget.offsetLeft,this.offsetY=this.event.layerY-this.origTarget.offsetTop),this.wheelDelta=this.event.wheelDelta,null==this.wheelDelta&&(this.wheelDelta=40*-this.event.detail)}return __extends(e,t),e}(n),o=function(t){return s.test(t.type)?new i.MouseEvent(t):new n(t)},u=/[\.#]/,a=function(t,e){return u.test(t)?function(n){var r;if(e||(e=document),r=n.target.node,r.matches(t))return!0;for(;(r=r.parentNode)!==e;)if(r.matches(t))return n.target=i.Nod.create(r)}:function(e){return e.target.node.matches(t)}},i.NodEventDispatcher=function(t){function e(){var t=this;e.__super__.constructor.apply(this,arguments),this.native_event_listener=function(e){return t.trigger(o(e))}}return __extends(e,t),e.prototype.listen=function(t,e,n,i){return this.on(e,n,i,a(t))},e.prototype.add_native_listener=function(t){return n.has_delegate(t)?n.delegates[t].add(this.node,this.native_event_listener):n.add(this.node,t,this.native_event_listener)},e.prototype.remove_native_listener=function(t){return n.has_delegate(t)?n.delegates[t].remove(this.node):n.remove(this.node,t,this.native_event_listener)},e.prototype.add_listener=function(t){return this.listeners[t.type]||(this.add_native_listener(t.type),n.has_alias(t.type)&&this.add_native_listener(n.aliases[t.type])),e.__super__.add_listener.apply(this,arguments)},e.prototype.remove_type=function(t){return this.remove_native_listener(t),n.has_alias(t)&&this.remove_native_listener(n.aliases[t]),e.__super__.remove_type.apply(this,arguments)},e.prototype.remove_all=function(){var t,i,r,s,o=this;s=this.listeners,r=function(){return o.remove_native_listener(i),n.has_alias(i)?o.remove_native_listener(n.aliases[i]):void 0};for(i in s)__hasProp.call(s,i)&&(t=s[i],r());return e.__super__.remove_all.apply(this,arguments)},e}(i.EventDispatcher)}(this);var __hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var i in e)__hasProp.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};!function(t){"use strict";var e,n,i,r,s,o,a,u,c,l,h,p,f;for(n=t.pi=t.pi||{},r=n.utils,h=function(t,e){return n.Nod.prototype[t]=function(t,n){var i,r;if("object"!=typeof t)return e.call(this,t,n);for(i in t)__hasProp.call(t,i)&&(r=t[i],e.call(this,i,r))}},a=function(t){var e,i,s,o;for(i=function(){var t;t=e,n.Nod.prototype[t]=function(e){return void 0===e?this.node["offset"+r.capitalize(t)]:(this.node.style[t]=Math.round(e)+"px",this)}},s=0,o=t.length;o>s;s++)e=t[s],i()},l=function(t){return t instanceof n.Nod?t.node:"string"==typeof t?s(t):t},o=function(t){var e,n;return n=t.split("-"),n[0]+function(){var t,i,s,o;for(s=n.slice(1),o=[],t=0,i=s.length;i>t;t++)e=s[t],o.push(r.capitalize(e));return o}().join("")},f=function(t){return r.snake_case(t).replace("_","-")},s=function(t){var e,n,i,r,s,o;for(i=document.createElement("div"),i.innerHTML=t,e=document.createDocumentFragment(),o=i.children,r=0,s=o.length;s>r;r++)n=o[r],e.appendChild(n);return e},n.Nod=function(t){function e(t){e.__super__.constructor.apply(this,arguments),this.node=t,this.node&&(this.node._nod=this)}return __extends(e,t),e.create=function(t){switch(!1){case!!t:return null;case!(t instanceof this):return t;case!("undefined"!=typeof t._nod):return t._nod;case!r.is_html(t):return this.create_html(t);case"string"!=typeof t:return new this(document.createElement(t));default:return new this(t)}},e.create_html=function(t){var e;return e=document.createElement("div"),e.innerHTML=t,new this(e.firstChild)},e.prototype.find=function(t){return n.Nod.create(this.node.querySelector(t))},e.prototype.all=function(t){return this.node.querySelectorAll(t)},e.prototype.each=function(t,e){var n,i,r,s,o,a;for(n=0,o=this.node.querySelectorAll(t),a=[],r=0,s=o.length;s>r&&(i=o[r],e.call(null,i,n)!==!0);r++)a.push(n++);return a},e.prototype.first=function(t){return this.find(t)},e.prototype.last=function(t){return this.find(""+t+":last-child")},e.prototype.nth=function(t,e){return this.find(""+t+":nth-child("+e+")")},e.prototype.parent=function(){return n.Nod.create(this.node.parentNode)},e.prototype.children=function(t){var e,n,i,r,s;if("function"==typeof t){for(e=0,s=this.node.children,i=0,r=s.length;r>i&&(n=s[i],t.call(null,n,e)!==!0);i++)e++;return this}return this.node.children},e.prototype.wrap=function(){var t;return t=n.Nod.create("div"),this.node.parentNode.insertBefore(t.node,this.node),t.append(this.node),n.Nod.create(t)},e.prototype.prepend=function(t){return t=l(t),this.node.insertBefore(t,this.node.firstChild),this},e.prototype.append=function(t){return t=l(t),this.node.appendChild(t),this},e.prototype.insertBefore=function(t){return t=l(t),this.node.parentNode.insertBefore(t,this.node),this},e.prototype.insertAfter=function(t){return t=l(t),this.node.parentNode.insertBefore(t,this.node.nextSibling),this},e.prototype.detach=function(){return this.node.parentNode.removeChild(this.node),this},e.prototype.detach_children=function(){for(;this.node.children.length;)this.node.removeChild(this.node.children[0]);return this},e.prototype.remove=function(){return this.detach(),this.html(""),this},e.prototype.empty=function(){return this.html(""),this},e.prototype.clone=function(){var t;return t=document.createElement(this.node.nameNode),t.innerHTML=this.node.outerHTML,new n.Nod(t.firstChild)},e.prototype.html=function(t){return null!=t?(this.node.innerHTML=t,this):this.node.innerHTML},e.prototype.text=function(t){return null!=t?(this.node.textContent=t,this):this.node.textContent},e.prototype.value=function(t){return null!=t?(this.node.value=t,this):this.node.value},e.prototype.addClass=function(){var t,e,n;for(e=0,n=arguments.length;n>e;e++)t=arguments[e],this.node.classList.add(t);return this},e.prototype.removeClass=function(){var t,e,n;for(e=0,n=arguments.length;n>e;e++)t=arguments[e],this.node.classList.remove(t);return this},e.prototype.toggleClass=function(t){return this.node.classList.toggle(t),this},e.prototype.hasClass=function(t){return this.node.classList.contains(t)},e.prototype.x=function(){var t,e;for(e=this.node.offsetLeft,t=this.node;t=t.offsetParent;)e+=t.offsetLeft;return e},e.prototype.y=function(){var t,e;for(e=this.node.offsetTop,t=this.node;t=t.offsetParent;)e+=t.offsetTop;return e},e.prototype.move=function(t,e){return this.style({left:t,top:e})},e.prototype.position=function(){return{x:this.x(),y:this.y()}},e.prototype.offset=function(){return{x:this.node.offsetLeft,y:this.node.offsetTop}},e.prototype.size=function(t,e){var n,i;return null==t&&(t=null),null==e&&(e=null),null==t||null==e?{width:this.width(),height:this.height()}:(null!=t&&null!=e?(this.width(t),this.height(e)):(n=this.height(),i=this.width(),null!=t?(this.width(t),this.height(n*t/i)):(this.height(e),this.width(i*e/n))),void this.trigger("resize"))},e.prototype.show=function(){return this.node.style.display="block"},e.prototype.hide=function(){return this.node.style.display="none"},e.prototype.focus=function(){return this.node.focus(),this},e.prototype.blur=function(){return this.node.blur(),this},e.prototype.dispose=function(){return this.off(),delete this.node._nod,delete this.node},e}(n.NodEventDispatcher),h("data",function(){return"undefined"==typeof DOMStringMap?function(t,e){var n,i,r,s,a,u;if(void 0===t){for(i={},a=this.node.attributes,r=0,s=a.length;s>r;r++)n=a[r],0===n.name.indexOf("data-")&&(i[o(n.name.slice(5))]=n.value);return i}return t="data-"+f(t),null==e?(u=this.attr(t),null===u&&(u=void 0),void 0===e?u:(this.attr(t,null),u)):this.attr(t,e)}:function(t,e){var n;return void 0===t?this.node.dataset:(n=this.node.dataset,void 0===e?n[t]:null===e?(e=n[t],delete n[t],e):n[t]=e)}}()),h("style",function(t,e){return void 0===e?this.node.style[t]:this.node.style[t]=e}),h("attr",function(t,e){return void 0===e?this.node.getAttribute(t):(null===e&&this.node.removeAttribute(t),this.node.setAttribute(t,e))}),a(["top","left","width","height"]),p=["top","left","width","height"],u=0,c=p.length;c>u;u++)e=p[u],i="scroll"+r.capitalize(e),n.Nod.prototype[i]=function(){return this.node[i]};return n.NodRoot=function(t){function e(){if(n.NodRoot.instance)throw"NodRoot is already defined!";n.NodRoot.instance=this,e.__super__.constructor.call(this,document.documentElement)}return __extends(e,t),e.instance=null,e.prototype.initialize=function(){var t,e,i,s=this;if(i=document.attachEvent?"complete":"interactive",this._loaded="complete"===document.readyState,this._loaded||(this._loaded_callbacks=[],t=function(){return r.debug("DOM loaded"),s._loaded=!0,s.fire_all(),n.NodEvent.remove(window,"load",t)},n.NodEvent.add(window,"load",t)),!this._ready){if(document.addEventListener){if(this._ready=document.readyState===i,this._ready)return;return this._ready_callbacks=[],e=function(){return r.debug("DOM ready"),s._ready=!0,s.fire_ready(),document.removeEventListener("DOMContentLoaded",e)},document.addEventListener("DOMContentLoaded",e)}if(this._ready=document.readyState===i,this._ready)return;return this._ready_callbacks=[],e=function(){return document.readyState===i?(r.debug("DOM ready"),s._ready=!0,s.fire_ready(),document.detachEvent("onreadystatechange",e)):void 0},document.attachEvent("onreadystatechange",e)}},e.prototype.ready=function(t){return this._ready?t.call(null):this._ready_callbacks.push(t)},e.prototype.loaded=function(t){return this._loaded?t.call(null):this._loaded_callbacks.push(t)},e.prototype.fire_all=function(){var t;for(this._ready_callbacks&&this.fire_ready();t=this._loaded_callbacks.shift();)t.call(null);return this._loaded_callbacks=null},e.prototype.fire_ready=function(){for(var t;t=this._ready_callbacks.shift();)t.call(null);return this._ready_callbacks=null},e.prototype.scrollTop=function(){return this.node.scrollTop||document.body.scrollTop},e.prototype.scrollLeft=function(){return this.node.scrollLeft||document.body.scrollLeft},e.prototype.scrollHeight=function(){return this.node.scrollHeight},e.prototype.scrollWidth=function(){return this.node.scrollWidth},e.prototype.height=function(){return window.innerHeight||this.node.clientHeight},e.prototype.width=function(){return window.innerWidth||this.node.clientWidth},e}(n.Nod),n.Nod.root=new n.NodRoot,n.Nod.win=new n.Nod(window),n.Nod.root.initialize()}(this),function(t){"use strict";var e,n;return e=t.pi=t.pi||{},n=e.utils,e.NodEvent.register_alias("mousewheel","DOMMouseScroll")}(this);var __slice=[].slice;!function(t){"use strict";var e,n,i,r,s,o,a;n=t.pi=t.pi||{},i=n.utils,n.log_level||(n.log_level="info"),s={error:{color:"#dd0011",sort:4},debug:{color:"#009922",sort:0},info:{color:"#1122ff",sort:1},warning:{color:"#ffaa33",sort:2}},a=function(t){return s[n.log_level].sort<=s[t].sort},i.log=function(){var t,e;return t=arguments[0],e=2<=arguments.length?__slice.call(arguments,1):[],a(t)&&console.log("%c "+i.time.now("%H:%M:%S:%L")+" ["+t+"]","color: "+s[t].color,e)},o=[];for(e in s)r=s[e],o.push(i[e]=i.curry(i.log,e));return o}(this),function(t){"use strict";var e,n,i,r,s;return e=t.pi.utils,r=/%([a-zA-Z])/g,s=function(){return 0==="%a".split(r).length?function(t){var e,n,i,s,o;for(i=t.match(r),s=t.split(r),o=[],"%"===t[0]&&o.push("",i.shift()[1]),n=i.length+s.length,e=!1;n>0;)o.push(e?i.shift()[1]:s.shift()),e=!e,n--;return o}:function(t){return t.split(r)}}(),i=function(t,e){var n;for(null==e&&(e=1),n=10;e;)n>t&&(t="0"+t),n*=10,e--;return t},n={H:function(t){return i(t.getHours())},k:function(t){return t.getHours()},I:function(t){return i(n.l(t))},l:function(t){var e;return e=t.getHours(),e>12?e-12:e},M:function(t){return i(t.getMinutes())},S:function(t){return i(t.getSeconds())},L:function(t){return i(t.getMilliseconds(),2)},z:function(t){var e,n;return e=t.getTimezoneOffset(),n=e>0?"-":"+",e=Math.abs(e),n+i(Math.floor(e/60))+":"+i(e%60)},Y:function(t){return t.getFullYear()},y:function(t){return(t.getFullYear()+"").slice(2)},m:function(t){return i(t.getMonth()+1)},d:function(t){return i(t.getDate())},P:function(t){return t.getHours()>11?"PM":"AM"},p:function(t){return n.P(t).toLowerCase()}},e.time={now:function(t){return e.time.format(new Date,t)},format:function(t,e){var i,r,o,a,u,c;if(null==e)return t;for(r=s(e),i=!1,a="",u=0,c=r.length;c>u;u++)o=r[u],a+=i?n[o].call(null,t):o,i=!i;return a}}}(this);var __hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var i in e)__hasProp.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},__slice=[].slice;!function(t){"use strict";var e,n,i,r,s,o,a,u;r=t.pi=t.pi||{},s=r.utils,r.config={},e=r.Nod,r._storage={},r.Base=function(t){function n(t,e){this.node=t,this.options=null!=e?e:{},n.__super__.constructor.apply(this,arguments),this.node&&(this.pid=this.data("pi"),this.pid&&(r._storage[this.pid]=this),this.initialize(),this.init_plugins(),this.visible=this.enabled=!0,this.active=!1,(this.options.disabled||this.hasClass("is-disabled"))&&this.disable(),(this.options.hidden||this.hasClass("is-hidden"))&&this.hide(),(this.options.active||this.hasClass("is-active"))&&this.activate(),this.setup_events())}return __extends(n,t),n.prototype.init_nod=function(t){return"string"==typeof t&&(t=e.root.find(t)||t),e.create(t)},n.prototype.init_plugins=function(){var t,e,n,i,r;if(null!=this.options.plugins){for(i=this.options.plugins,r=[],e=0,n=i.length;n>e;e++)t=i[e],r.push(this.attach_plugin(t));return r}},n.prototype.attach_plugin=function(t){return t=s.camelCase(t),null!=r[t]?(s.debug("plugin attached "+t),new r[t](this)):void 0},n.prototype.initialize=function(){return this._initialized=!0},n.prototype.setup_events=function(){var t,e,n,i,s;i=this.options.events,s=[];for(t in i)n=i[t],s.push(function(){var i,s,o,a;for(o=n.split(/;\s*/),a=[],i=0,s=o.length;s>i;i++)e=o[i],a.push(this.on(t,r.str_to_event_handler(e,this)));return a}.call(this));return s},n.prototype.delegate=function(t,e){var n,i,r,s,o=this;for(e="string"==typeof e?this[e]:e,i=function(t){return o[t]=function(){var n;return n=1<=arguments.length?__slice.call(arguments,0):[],e[t].apply(e,n)}},r=0,s=t.length;s>r;r++)n=t[r],i(n)},n.prototype.trigger=function(t,e){return this.enabled||"disabled"===t?n.__super__.trigger.call(this,t,e):void 0},n.prototype.show=function(){return this.visible||(this.removeClass("is-hidden"),this.visible=!0,this.trigger("shown")),this},n.prototype.hide=function(){return this.visible&&(this.addClass("is-hidden"),this.visible=!1,this.trigger("hidden")),this},n.prototype.enable=function(){return this.enabled||(this.removeClass("is-disabled"),this.attr("disabled",null),this.enabled=!0,this.trigger("enabled")),this},n.prototype.disable=function(){return this.enabled&&(this.addClass("is-disabled"),this.attr("disabled","disabled"),this.enabled=!1,this.trigger("disabled")),this},n.prototype.activate=function(){return this.active||(this.addClass("is-active"),this.active=!0,this.trigger("active")),this},n.prototype.deactivate=function(){return this.active&&(this.removeClass("is-active"),this.active=!1,this.trigger("inactive")),this},n}(r.Nod),i=new RegExp("option(\\w+)","i"),n=new RegExp("event(\\w+)","i"),r.find=function(t){return r._storage[t]
},r.init_component=function(t){var e,n;if(n=s.camelCase(t.data("component")||"base"),e=r[n],null==e)throw new ReferenceError("unknown or initialized component: "+n);return t instanceof e?t:(s.debug("component created: "+n),new r[n](t.node,r.gather_options(t)))},r.dispose_component=function(t){var e;return t=e="object"==typeof t?t:r.find(t),null!=t?(t.dispose(),null!=t.pid?delete r._storage[t.pid]:void 0):void 0},r.piecify=function(n){return t=n instanceof e?n:e.create(n||document.documentElement),t.each(".pi",function(t){return r.init_component(e.create(t))}),null==n?r.event.trigger("piecified"):void 0},r.gather_options=function(t){var r,o,a,u,c;t=t instanceof e?t:new e(t),a={component:t.data("component")||"base",plugins:t.data("plugins")?t.data("plugins").split(/\s+/):null,events:{}},c=t.data();for(r in c)u=c[r],(o=r.match(i))?a[s.snake_case(o[1])]=s.serialize(u):(o=r.match(n))&&(a.events[s.snake_case(o[1])]=u);return a},a=/([\w\._]+)\.([\w_]+)/,r.call=function(){var t,e,n,i,o,u,c,l,h,p,f,d,_,y;n=arguments[0],l=arguments[1],e=3<=arguments.length?__slice.call(arguments,2):[];try{return s.debug("pi call: component - "+n+"; method chain - "+l),h="object"==typeof n?n:r.find(n),d=function(){var t,e,n,i,r;if(l.indexOf(".")<0)return[l,h];for(i=l.match(a),y=i[0],f=i[1],c=i[2],p=h,r=f.split("."),t=function(t){return p=p[t]},e=0,n=r.length;n>e;e++)o=r[e],t(o);return[c,p]}(),u=d[0],h=d[1],null!=(null!=(_=h[u])?_.call:void 0)?h[u].apply(h,function(){var n,i,r;for(r=[],n=0,i=e.length;i>n;n++)t=e[n],r.push("function"==typeof t?t.call(null):t);return r}()):h[u]}catch(v){return i=v,s.error(i)}},u=/^['"].+['"]$/,r.prepare_arg=function(t,e){return"@"===t[0]?r.str_to_fun(t,e):u.test(t)?t.slice(1,-1):s.serialize(t)},o=/@([\w]+)(?:\.([\w\.]+)(?:\(([@\w\.\(\),'"-_]+)\))?)?/,r.str_to_fun=function(t,e){var n,i,s;return i=t.match(o),s="this"===i[1]?e:i[1],i[2]?curry(r.call,[s,i[2]].concat(i[3]?function(){var t,s,o,a;for(o=i[3].split(","),a=[],t=0,s=o.length;s>t;t++)n=o[t],a.push(r.prepare_arg(n,e));return a}():[])):"object"==typeof s?function(){return s}:function(){return r.find(s)}},r.str_to_event_handler=function(t,e){var n;return n=r.str_to_fun(t,e),function(t){return n(t.data)}},r.event=new r.EventDispatcher,s.extend(e.prototype,{piecify:function(){return r.piecify(this)},pi_call:function(t,e){return this._pi_call&&this._pi_action===e||(this._pi_action=e,this._pi_call=r.str_to_fun(e,t)),this._pi_call.call(null)},dispose:function(){return r.dispose_component(this)}}),e.root.ready(function(){return e.root.listen("a","click",function(t){"@"===t.target.attr("href")[0]&&(s.debug("handle pi click: "+t.target.attr("href")),t.target.pi_call(t.target,t.target.attr("href")),t.cancel())})}),t.curry=s.curry,t.delayed=s.delayed,t.after=s.after,t.debounce=s.debounce,t.$=function(t){return"@"===t[0]?r.find(t.slice(1)):s.is_html(t)?e.create(t):e.root.find(t)}}(this);var __hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var i in e)__hasProp.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};!function(t){"use strict";var e,n,i;return e=t.pi=t.pi||{},n=e.utils,e.TextInput=function(t){function e(){return i=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.prototype.initialize=function(){return this.input="INPUT"===this.node.nodeName?this:this.find("input"),this.editable=!0,(this.options.readonly||this.hasClass("is-readonly"))&&this.make_readonly(),e.__super__.initialize.apply(this,arguments)},e.prototype.make_editable=function(){return this.editable||(this.input.attr("readonly",null),this.removeClass("is-readonly"),this.editable=!0,this.trigger("editable")),this},e.prototype.make_readonly=function(){return this.editable&&(this.input.attr("readonly","readonly"),this.addClass("is-readonly"),this.editable=!1,this.trigger("readonly")),this},e.prototype.value=function(t){return this===this.input?e.__super__.value.apply(this,arguments):null!=t?(this.input.node.value=t,this):this.input.node.value},e.prototype.clear=function(){return this.input.value("")},e}(e.Base)}(this);var __hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var i in e)__hasProp.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};!function(t){"use strict";var e,n,i;return e=t.pi=t.pi||{},n=e.utils,e.Button=function(t){function e(){return i=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments)},e}(e.Base)}(this);var __hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var i in e)__hasProp.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};!function(t){"use strict";var e,n,i;return e=t.pi=t.pi||{},n=e.utils,e.List=function(t){function r(){return i=r.__super__.constructor.apply(this,arguments)}return __extends(r,t),r.string_matcher=function(t){var e,n,i,r;return t.indexOf(":")>0?(r=t.split(":"),i=r[0],e=r[1],n=new RegExp(e,"i"),i=i.split(","),function(t){var e,r,s,o;for(r=0,s=i.length;s>r;r++)if(e=i[r],null!=(o=t.nod.find(e))?o.text().match(n):void 0)return!0;return!1}):(n=new RegExp(t,"i"),function(t){return!!t.nod.text().match(n)})},r.object_matcher=function(t,e){var n,i,r;null==e&&(e=!0),r=function(e,n){return"string"==typeof n?t[e]=function(t){return!!t.match(new RegExp(n,"i"))}:"function"!=typeof n?t[e]=function(t){return n===t}:void 0};for(n in t)i=t[n],r(n,i);return function(i){var r,s;s=!1;for(n in t)if(r=t[n],null!=i[n])if(r(i[n])){if(s=!0,!e)return s}else if(e)return!1;return s}},r.prototype.initialize=function(){var t=this;return this.list_klass=this.options.list_klass||"list",this.item_klass=this.options.item_klass||"item",this.items_cont=this.find("."+this.list_klass),this.items_cont||(this.items_cont=this),this.item_renderer=function(t){var e,i,r,s;e={},s=t.data();for(i in s)__hasProp.call(s,i)&&(r=s[i],e[n.snake_case(i)]=n.serialize(r));return e.nod=t,e},this.items=[],this.buffer=document.createDocumentFragment(),this.parse_html_items(),this._check_empty(),null==this.options.noclick&&this.listen("."+this.item_klass,"click",function(e){return"A"!==e.origTarget.nodeName?(t._item_clicked(e.target),e.cancel()):void 0}),r.__super__.initialize.apply(this,arguments)},r.prototype.parse_html_items=function(){var t=this;return this.items_cont.each("."+this.item_klass,function(n){return t.add_item(e.Nod.create(n))}),this._flush_buffer(!1)},r.prototype.data_provider=function(t){var e,n,i;if(null==t&&(t=null),this.items.length&&this.clear(),null==t||!t.length)return void this._check_empty();for(n=0,i=t.length;i>n;n++)e=t[n],this.add_item(e,!1);return this.update()},r.prototype.add_item=function(t,e){var n;return null==e&&(e=!0),n=this._create_item(t),this.items.push(n),this._check_empty(),n.nod.data("listIndex",this.items.length-1),e?this.items_cont.append(n.nod):this.buffer.appendChild(n.nod.node),e?this.trigger("update",{type:"item_added",item:n}):void 0},r.prototype.add_item_at=function(t,e,n){var i,r;return null==n&&(n=!0),this.items.length-1<e?void this.add_item(t,n):(i=this._create_item(t),this.items.splice(e,0,i),r=this.items[e+1],i.nod.data("listIndex",e),r.nod.insertBefore(i.nod),this._need_update_indeces=!0,n?(this._update_indeces(),this.trigger("update",{type:"item_added",item:i})):void 0)},r.prototype.remove_item=function(t,e){var n;null==e&&(e=!0),n=this.items.indexOf(t),n>-1&&(this.items.splice(n,1),this._destroy_item(t),t.nod.data("listIndex",null),this._check_empty(),this._need_update_indeces=!0,e&&(this._update_indeces(),this.trigger("update",{type:"item_removed",item:t})))},r.prototype.remove_item_at=function(t,e){var n;return null==e&&(e=!0),this.items.length-1<t?void 0:(n=this.items[t],this.remove_item(n,e))},r.prototype.where=function(t){var e,n,i,r,s,o;for(n="string"==typeof t?this.constructor.string_matcher(t):this.constructor.object_matcher(t),s=this.items,o=[],i=0,r=s.length;r>i;i++)e=s[i],n(e)&&o.push(e);return o},r.prototype.size=function(){return this.items.length},r.prototype.update=function(){return this._flush_buffer(),this._need_update_indeces&&this._update_indeces(),this.trigger("update")},r.prototype.clear=function(){return this.items_cont.detach_children(),this.items.length=0,this.trigger("update",{type:"clear"})},r.prototype._update_indeces=function(){var t,e,n,i,r;for(r=this.items,t=n=0,i=r.length;i>n;t=++n)e=r[t],e.nod.data("listIndex",t);return this._need_update_indeces=!1},r.prototype._check_empty=function(){return this.empty||0!==this.items.length?this.empty&&this.items.length>0?(this.removeClass("is-empty"),this.empty=!1,this.trigger("full")):void 0:(this.addClass("is-empty"),this.empty=!0,this.trigger("empty"))},r.prototype._create_item=function(t){var n;return t.nod instanceof e.Nod?t:(n=this.item_renderer(t),null!=this.options.pi_items&&(n.nod=e.init_component(n.nod),n.nod.piecify()),n)},r.prototype._destroy_item=function(t){var e;return null!=(e=t.nod)&&"function"==typeof e.remove?e.remove():void 0},r.prototype._flush_buffer=function(t){return null==t&&(t=!0),t&&this.items_cont.append(this.buffer),this.buffer.innerHTML=""},r.prototype._item_clicked=function(t){var e;if(null!=t.data("listIndex"))return e=this.items[t.data("listIndex")],this.trigger("item_click",{item:e})},r}(e.Base)}(this);var __hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var i in e)__hasProp.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},__slice=[].slice;!function(t){"use strict";var e,n,i,r,s,o;return e=t.$,i=t.pi=t.pi||{},r=i.utils,o=0,n=null!=i.config.swf_version||"11.0.0",i.SwfPlayer=function(t){function e(){return s=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.prototype.initialize=function(){var t;return t=document.createElement("div"),this.player_id="swf_player_"+ ++o,t.id=this.player_id,this.append(t),null!=this.options.url&&this.enabled&&this.load(this.options.url),e.__super__.initialize.apply(this,arguments)},e.prototype.load=function(t,e){var i,r,s;null==e&&(e={}),t||(t=this.options.url),s=this.options;for(i in s)r=s[i],e[i]||(e[i]=r);return swfobject.embedSWF(t,this.player_id,"100%","100%",n,"",e,{allowScriptAccess:!0,wmode:"transparent"})},e.prototype.clear=function(){return this.empty()},e.prototype.as3_call=function(){var t,e,n,i;return e=arguments[0],t=2<=arguments.length?__slice.call(arguments,1):[],n=swfobject.getObjectById(this.player_id),n&&null!=(i=n[e])?i.apply(n,t):void 0},e.prototype.as3_event=function(t){return r.debug(t),this.trigger("as3_event",t)},e}(i.Base)}(this);var __hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var i in e)__hasProp.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};!function(t){"use strict";var e,n,i;return e=t.pi=t.pi||{},n=e.utils,e.TextArea=function(t){function n(){return i=n.__super__.constructor.apply(this,arguments)}return __extends(n,t),n.prototype.initialize=function(){return this.input="TEXTAREA"===this.node.nodeName?this:this.find("textarea"),this.editable=!0,(this.options.readonly||this.hasClass("is-readonly"))&&this.make_readonly(),this.options.autosize===!0&&this.enable_autosize(),e.Base.prototype.initialize.apply(this)},n.prototype.autosizer=function(){var t=this;return this._autosizer||(this._autosizer=function(){return t.input.height(t.input.node.scrollHeight)})},n.prototype.enable_autosize=function(){return this._autosizing||(this.input.on("change",this.autosizer()),this._autosizing=!0,this.autosizer()()),this},n.prototype.disable_autosize=function(){return this._autosizing&&(this.input.style("height",null),this.input.off("change",this.autosizer()),this._autosizing=!1),this},n}(e.TextInput)}(this),function(t){"use strict";var e,n;return e=t.pi=t.pi||{},n=e.utils,e.DragSelect=function(){function t(t){return this.list=t,null==this.list.selectable?void n.error("Selectable plugin is required!"):(this._direction=this.list.options.direction||"y",void this.list.on("mousedown",this.mouse_down_listener()))}return t.prototype._item_under_point=function(t){return this._item_bisearch(0,t[this._direction],t)},t.prototype._item_bisearch=function(t,e,n){var i,r,s,o;return r=e/this._height*this._len|0,0===r&&(r=e>0?1:-1),i=t+r,0>i?0:i>this._len-1?this._len-1:(s=this.list.items[i],o=this._item_match_point(s.nod,n),0===o?i:this._item_bisearch(i,o,n))},t.prototype._item_match_point=function(t,e){var n,i,r,s,o;return o=t.position(),n=o.x,i=o.y,s={x:n-this._offset.x,y:i-this._offset.y},r="y"===this._direction?t.height():t.width(),e[this._direction]>=s[this._direction]&&s[this._direction]+r>e[this._direction]?0:e[this._direction]-s[this._direction]},t.prototype._update_range=function(t){var e,i;if(t!==this._last_index){switch((this._last_index-this._start_index)*(t-this._start_index)<0&&this._update_range(this._start_index),n.debug("next index: "+t+"; last index: "+this._last_index+"; start: "+this._start_index),i=t-this._last_index>0,e=this._last_index!==this._start_index?this._last_index-this._start_index>0:i,n.debug("below: "+e+"; downward: "+i),!1){case!(i&&e):this._select_range(this._last_index+1,t);break;case!(!i&&!e):this._select_range(t,this._last_index-1);break;case!(i&&!e):this._clear_range(this._last_index,t-1);break;default:this._clear_range(t+1,this._last_index)}return this._last_index=t}},t.prototype._clear_range=function(t,e){var n,i,r,s,o;for(s=this.list.items.slice(t,+e+1||9e9),o=[],i=0,r=s.length;r>i;i++)n=s[i],o.push(this.list._deselect(n));return o},t.prototype._select_range=function(t,e){var n,i,r,s,o;for(s=this.list.items.slice(t,+e+1||9e9),o=[],i=0,r=s.length;r>i;i++)n=s[i],o.push(this.list._select(n));return o},t.prototype.mouse_down_listener=function(){var t=this;return this._mouse_down_listener?this._mouse_down_listener:this._mouse_down_listener=function(n){var i,r,s;return i=t.list.items_cont.position(),r=i.x,s=i.y,t._offset={x:r,y:s},t._start_point={x:n.pageX-r,y:n.pageY-s},t._wait_drag=after(300,function(){return t._height=t.list.height(),t._len=t.list.items.length,t._start_index=t._item_under_point(t._start_point),t._last_index=t._start_index,t.list._select(t.list.items[t._start_index]),t.list.selected().length&&t.list.trigger("selected"),t.list.on("mousemove",t.mouse_move_listener()),t._dragging=!0}),e.Nod.root.on("mouseup",t.mouse_up_listener())}},t.prototype.mouse_up_listener=function(){var t=this;return this._mouse_up_listener?this._mouse_up_listener:this._mouse_up_listener=function(n){return e.Nod.root.off("mouseup",t.mouse_up_listener()),t._dragging?(t.list.off("mousemove",t.mouse_move_listener()),t._dragging=!1,n.stopImmediatePropagation(),n.preventDefault()):clearTimeout(t._wait_drag)}},t.prototype.mouse_move_listener=function(){var t=this;return this._mouse_move_listener?this._mouse_move_listener:this._mouse_move_listener=debounce(300,function(e){var n;return n={x:e.pageX-t._offset.x,y:e.pageY-t._offset.y},t._update_range(t._item_under_point(n))})},t}()}(this);var __indexOf=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},__hasProp={}.hasOwnProperty;!function(t){"use strict";var e,n,i,r;return e=t.pi=t.pi||{},n=e.utils,r={"?":function(t){return function(e){return __indexOf.call(t,e)>=0}},"?&":function(t){return function(e){var n,i,r;for(i=0,r=t.length;r>i;i++)if(n=t[i],!(__indexOf.call(e,n)>=0))return!1;return!0}},">":function(t){return function(e){return e>=t}},"<":function(t){return function(e){return t>=e}}},i=/^([\w\d_]+)(\?&|>|<|\?)$/,e.Filterable=function(){function t(t){this.list=t,this.list.filterable=this,this.list.delegate(["filter"],this),this.list.filtered=!1}return t.prototype._matcher=function(t){var n,s,o,a;o={};for(n in t)__hasProp.call(t,n)&&(a=t[n],(s=n.match(i))?o[s[1]]=r[s[2]](a):o[n]=a);return e.List.object_matcher(o)},t.prototype._is_continuation=function(t){var e,n,i;i=this._prevf;for(e in i)if(__hasProp.call(i,e)&&(n=i[e],t[e]!==n))return!1;return!0},t.prototype._start_filter=function(){return this.filtered?void 0:(this.filtered=!0,this.list.addClass("is-filtered"),this._all_items=n.clone(this.list.items),this._prevf={},this.list.trigger("filter_start"))},t.prototype._stop_filter=function(){return this.filtered?(this.filtered=!1,this.list.removeClass("is-filtered"),this.list.data_provider(this._all_items),this._all_items=null,this.list.trigger("filter_stop")):void 0},t.prototype.filter=function(t){var e,i,r,s;return null==t?this._stop_filter():(this.filtered||this._start_filter(),r=this._is_continuation(t)?this.list.items.slice():n.clone(this._all_items),this._prevf=t,i=this._matcher(t),s=function(){var t,n,s;for(s=[],t=0,n=r.length;n>t;t++)e=r[t],i(e)&&s.push(e);return s}(),this.list.data_provider(s),this.list.trigger("filter_update"))},t}()}(this),function(t){"use strict";var e,n,i;return e=t.jQuery,n=t.pi=t.pi||{},i=n.utils,n.JstRenderer=function(){function t(t){return"string"!=typeof t.options.renderer?void i.error("JST renderer name undefined"):(t.jst_renderer=JST[t.options.renderer],void(t.item_renderer=function(e){var r;return r=i.clone(e),r.nod=n.Nod.create(t.jst_renderer(e)),r}))}return t}()}(this),function(t){"use strict";var e,n;return e=t.pi=t.pi||{},n=e.utils,e.ScrollEnd=function(){function t(t){this.list=t,this.scroll_object="window"===this.list.options.scroll_object?e.Nod.root:this.list.items_cont,this.scroll_native_listener="window"===this.list.options.scroll_object?e.Nod.win:this.list.items_cont,this.list.scroll_end=this,this._prev_top=this.scroll_object.scrollTop(),this.list.options.scroll_end!==!1&&this.enable()}return t.prototype.enable=function(){return this.enabled?void 0:(this.scroll_native_listener.on("scroll",this.scroll_listener()),this.enabled=!0)},t.prototype.disable=function(){return this.enabled?(this.scroll_native_listener.off("scroll",this.scroll_listener()),this._scroll_listener=null,this.enabled=!1):void 0},t.prototype.scroll_listener=function(){var t=this;return null!=this._scroll_listener?this._scroll_listener:this._scroll_listener=debounce(500,function(){return t._prev_top<=t.scroll_object.scrollTop()&&t.list.height()-t.scroll_object.scrollTop()-t.scroll_object.height()<50&&t.list.trigger("scroll_end"),t._prev_top=t.scroll_object.scrollTop()})},t}()}(this),function(t){"use strict";var e,n,i,r,s;return e=t.pi=t.pi||{},n=e.utils,i=/<mark>([^<>]*)<\/mark>/gim,s=/[\.#a-z\s\[\]=\"-_,]/i,r=/data:([\w\d_]+)/gi,e.Searchable=function(){function t(t){this.list=t,this.update_scope(this.list.options.search_scope),this.list.searchable=this,this.list.delegate(["search","_start_search","_stop_search","_highlight_item"],this),this.list.searching=!1}return t.prototype.update_scope=function(t){return this.matcher_factory=this._matcher_from_scope(t),this._highlight_elements=t&&s.test(t)?function(e){var n,i,r,s,o;for(s=t.split(","),o=[],i=0,r=s.length;r>i;i++)n=s[i],o.push(e.nod.find(n));return o}:function(t){return[t.nod]}},t.prototype._matcher_from_scope=function(t){var n,i;return this.matcher_factory=null==t?e.List.string_matcher:r.test(t)?(t=t.replace(r,"$1"),i={},n=t.split(","),function(t){var r,s,o;for(s=0,o=n.length;o>s;s++)r=n[s],i[r]=t;return e.List.object_matcher(i,!1)}):function(n){return e.List.string_matcher(t+":"+n)}},t.prototype._is_continuation=function(t){var e;return 0===(null!=(e=t.match(this._prevq))?e.index:void 0)},t.prototype._start_search=function(){return this.searching?void 0:(this.searching=!0,this.list.addClass("is-searching"),this._all_items=n.clone(this.list.items),this._prevq="",this.list.trigger("search_start"))},t.prototype._stop_search=function(){return this.searching?(this.searching=!1,this.list.removeClass("is-searching"),this.list.data_provider(this._all_items),this._all_items=null,this.list.trigger("search_stop")):void 0},t.prototype._highlight_item=function(t,e){var n,r,s,o,a,u,c;for(r=this._highlight_elements(e),c=[],s=0,o=r.length;o>s;s++)n=r[s],null!=n&&(a=n.html(),u=new RegExp("((?:^|>)[^<>]*?)("+t+")","gim"),a=a.replace(i,"$1"),""!==t&&(a=a.replace(u,"$1<mark>$2</mark>")),c.push(n.html(a)));return c},t.prototype.search=function(t,e){var i,r,s,o,a,u;if(null==t&&(t=""),null==e&&(e=!1),""===t)return this._stop_search();if(this.searching||this._start_search(),s=this._is_continuation(t)?this.list.items.slice():n.clone(this._all_items),this._prevq=t,r=this.matcher_factory(t),o=function(){var t,e,n;for(n=[],t=0,e=s.length;e>t;t++)i=s[t],r(i)&&n.push(i);return n}(),this.list.data_provider(o),e)for(a=0,u=o.length;u>a;a++)i=o[a],this._highlight_item(t,i);return this.list.trigger("search_update")},t}()}(this),function(t){"use strict";var e,n;return e=t.pi=t.pi||{},n=e.utils,e.Selectable=function(){function t(t){var n=this;this.list=t,this.type=this.list.options.select||"radio",this.list.on("item_click",this.item_click_handler()),this.list.on("update",this.update_handler()),this.list.items_cont.each(".is-selected",function(t){return n.list.items[e.Nod.create(t).data("listIndex")].selected=!0}),this.list.selectable=this,this.list.delegate(["clear_selection","selected","selected_item","select_all","_select","_deselect","_toggle_select"],this)}return t.prototype.item_click_handler=function(){var t=this;return this._item_click_handler?this._item_click_handler:this._item_click_handler=function(e){t.type.match("radio")&&!e.data.item.selected?(t.list.clear_selection(!0),t.list._select(e.data.item),t.list.trigger("selected",e.data.item)):t.type.match("check")&&(t.list._toggle_select(e.data.item),t.list.selected().length?t.list.trigger("selected",t.selected()):t.list.trigger("selection_cleared"))}},t.prototype.update_handler=function(){var t=this;return this._update_handler?this._update_handler:this._update_handler=function(e){var n;return null==(null!=(n=e.data)?n.type:void 0)||"item_added"!==e.data.type?t._check_selected():void 0}},t.prototype._check_selected=function(){return this.list.selected().length?void 0:this.list.trigger("selection_cleared")},t.prototype._select=function(t){return t.selected?void 0:(t.selected=!0,this._selected=null,t.nod.addClass("is-selected"))},t.prototype._deselect=function(t){return t.selected?(t.selected=!1,this._selected=null,t.nod.removeClass("is-selected")):void 0},t.prototype._toggle_select=function(t){return t.selected?this._deselect(t):this._select(t)},t.prototype.clear_selection=function(t){var e,n,i,r;for(null==t&&(t=!1),r=this.list.items,n=0,i=r.length;i>n;n++)e=r[n],this._deselect(e);return t?void 0:this.list.trigger("selection_cleared")},t.prototype.select_all=function(){var t,e,n,i;for(i=this.list.items,e=0,n=i.length;n>e;e++)t=i[e],this._select(t);return this.selected().length?this.list.trigger("selected",this.selected()):void 0},t.prototype.selected=function(){var t;return null==this._selected&&(this._selected=function(){var e,n,i,r;for(i=this.list.items,r=[],e=0,n=i.length;n>e;e++)t=i[e],t.selected&&r.push(t);return r}.call(this)),this._selected},t.prototype.selected_item=function(){var t;return t=this.selected(),t.length?t[0]:null},t}()}(this),function(t){"use strict";var e,n;return e=t.pi=t.pi||{},n=e.utils,e.Sortable=function(){function t(t){this.list=t,this.list.sortable=this,this.list.delegate(["sort"],this)}return t.prototype.sort=function(t,e){return null==e&&(e=!1),"object"==typeof t?n.sort(this.list.items,t,e):n.sort_by(this.list.items,t,e),this.list.data_provider(this.list.items.slice()),this.list.trigger("sort_update",{fields:t,reverse:e})},t}()}(this);var __indexOf=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};!function(t){"use strict";var e;return e=function(){function t(t,e){this.nod=t,this.options=null!=e?e:{},this.options.rails===!0&&(this.options.name_transform=this._rails_name_transform),this.options.serialize===!0&&(this.options.parse_value=this._serialize)}return t.parse=function(e,n){return new t(e,n).parse()},t.fill=function(e,n){return new t(e,n).fill()},t.clear=function(e){return new t(e).clear()},t.prototype.parse=function(){return this._process_name_values(this._collect_name_values())},t.prototype.fill=function(t){var e=this;return this._traverse_input_nodes(this.nod,function(n){return e._fill_nod(n,t)})},t.prototype.clear=function(){var t=this;return this._traverse_input_nodes(this.nod,function(e){return t._clear_nod(e)})},t.prototype._process_name_values=function(t){var e,n,i,r,s,o,a=this;for(o={},n={},i=function(t){var e,i,r,s,u,c,l,h,p,f,d;if(r=t.name,u=t.value,!a.options.skip_empty||""!==u&&null!==u){for(c="",l=o,null!=a.options.name_transform&&(r=a.options.name_transform(r)),null!=a.options.parse_value&&(u=a.options.parse_value(u)),f=r.split("."),i=f.length,d=[],e=h=0,p=f.length;p>h;e=++h)s=f[e],d.push(function(t){var r,s,o,a;return t.indexOf("[]")>-1?(s=t.substr(0,t.indexOf("[")),c+=s,l[s]||(l[s]=[]),e===i-1?l[s].push(u):(a=f[e+1],n[c]||(n[c]=[]),r=n[c].length,!r||__indexOf.call(n[c],a)>=0&&(a.indexOf("[]")<0||a!==n[c][r-1])?(o={},l[s].push(o),n[c]=[]):o=l[s][l[s].length-1],n[c].push(a),l=o)):(c+=t,i-1>e?(l[t]||(l[t]={}),l=l[t]):l[t]=u)}(s));return d}},r=0,s=t.length;s>r;r++)e=t[r],i(e);return o},t.prototype._collect_name_values=function(){var t=this;return this._traverse_input_nodes(this.nod,function(e){return t._parse_nod(e)})},t.prototype._traverse_input_nodes=function(t,e){var n,i;for(i=this._to_array(e(t)),n=t.firstChild;null!=n;)i=i.concat(this._traverse_input_nodes(n,e)),n=n.nextSibling;return i},t.prototype._to_array=function(t){return null==t?[]:t instanceof Array?t:[t]},t.prototype._parse_nod=function(t){var e;if((this.options.disabled!==!1||!t.disabled)&&/(input|select|textarea)/i.test(t.nodeName)&&t.name&&(e=this._parse_nod_value(t),null!=e))return{name:t.name,value:e}},t.prototype._fill_nod=function(t,e){var n,i;if(/(input|select|textarea)/i.test(t.nodeName)&&(i=this._nod_data_value(t.name,e),null!=i))if("select"===t.nodeName.toLowerCase())this._fill_select(t,i);else{if("object"==typeof i)return;switch(n=t.type.toLowerCase(),!1){case!(/(radio|checkbox)/.test(n)&&i):t.checked=!0;break;case!(/(radio|checkbox)/.test(n)&&!i):t.checked=!1;break;default:t.value=i}}},t.prototype._fill_select=function(t,e){var n,i,r,s,o;for(e=e instanceof Array?e:[e],s=t.getElementsByTagName("option"),o=[],i=0,r=s.length;r>i;i++)n=s[i],o.push(function(t){var n;return t.selected=(n=t.value,__indexOf.call(e,n)>=0)}(n));return o},t.prototype._clear_nod=function(t){var e;if(/(input|select|textarea)/i.test(t.nodeName))if("select"===t.nodeName.toLowerCase())this._fill_select(t,[]);else switch(e=t.type.toLowerCase(),!1){case!/(radio|checkbox)/.test(e):t.checked=!1;break;default:t.value=""}},t.prototype._nod_data_value=function(t,e){var n,i,r,s;if(this.options.fill_prefix&&(t=t.replace(this.options.fill_prefix,"")),null!=this.options.name_transform&&(t=this.options.name_transform(t)),!(t.indexOf("[]")>-1)){for(s=t.split("."),i=0,r=s.length;r>i&&(n=s[i],e=e[n],null!=e);i++);return e}},t.prototype._parse_nod_value=function(t){var e;if("select"===t.nodeName.toLowerCase())return this._parse_select_value(t);switch(e=t.type.toLowerCase(),!1){case!(/(radio|checkbox)/.test(e)&&t.checked):return t.value;case!(/(radio|checkbox)/.test(e)&&!t.checked):return null;case!/(button|reset|submit|image)/.test(e):return null;default:return t.value}},t.prototype._parse_select_value=function(t){var e,n,i,r,s,o;if(e=t.multiple,!e)return t.value;for(s=t.getElementsByTagName("option"),o=[],i=0,r=s.length;r>i;i++)n=s[i],n.selected&&o.push(n.value);return o},t.prototype._rails_name_transform=function(t){return t.replace(/([a-z_\d\(\)\]])\[([^\]])/gi,"$1.$2").replace(/([a-z_\(\)\d])\]/gi,"$1")},t.prototype._serialize=function(t){return t=function(){switch(!1){case!(null==t||""===t):return null;case"true"!==t:return!0;case"false"!==t:return!1;case!isNaN(Number(t)):return t;default:return Number(t)}}()},t}(),"function"==typeof define&&null!=define.amd?define(e):"function"==typeof module?module.exports=e:t.FormerJS=e}(this),function(){!function(){"use strict";var Faye={VERSION:"1.0.1",BAYEUX_VERSION:"1.0",ID_LENGTH:160,JSONP_CALLBACK:"jsonpcallback",CONNECTION_TYPES:["long-polling","cross-origin-long-polling","callback-polling","websocket","eventsource","in-process"],MANDATORY_CONNECTION_TYPES:["long-polling","callback-polling","in-process"],ENV:"undefined"!=typeof window?window:global,extend:function(t,e,n){if(!e)return t;for(var i in e)e.hasOwnProperty(i)&&(t.hasOwnProperty(i)&&n===!1||t[i]!==e[i]&&(t[i]=e[i]));return t},random:function(t){return t=t||this.ID_LENGTH,csprng(t,36)},clientIdFromMessages:function(t){var e=this.filter([].concat(t),function(t){return"/meta/connect"===t.channel});return e[0]&&e[0].clientId},copyObject:function(t){var e,n,i;if(t instanceof Array){for(e=[],n=t.length;n--;)e[n]=Faye.copyObject(t[n]);return e}if("object"==typeof t){e=null===t?null:{};for(i in t)e[i]=Faye.copyObject(t[i]);return e}return t},commonElement:function(t,e){for(var n=0,i=t.length;i>n;n++)if(-1!==this.indexOf(e,t[n]))return t[n];return null},indexOf:function(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0,i=t.length;i>n;n++)if(t[n]===e)return n;return-1},map:function(t,e,n){if(t.map)return t.map(e,n);var i=[];if(t instanceof Array)for(var r=0,s=t.length;s>r;r++)i.push(e.call(n||null,t[r],r));else for(var o in t)t.hasOwnProperty(o)&&i.push(e.call(n||null,o,t[o]));return i},filter:function(t,e,n){if(t.filter)return t.filter(e,n);for(var i=[],r=0,s=t.length;s>r;r++)e.call(n||null,t[r],r)&&i.push(t[r]);return i},asyncEach:function(t,e,n,i){var r=t.length,s=-1,o=0,a=!1,u=function(){return o-=1,s+=1,s===r?n&&n.call(i):void e(t[s],l)},c=function(){if(!a){for(a=!0;o>0;)u();a=!1}},l=function(){o+=1,c()};l()},toJSON:function(t){return this.stringify?this.stringify(t,function(t,e){return this[t]instanceof Array?this[t]:e}):JSON.stringify(t)}};"undefined"!=typeof module?module.exports=Faye:"undefined"!=typeof window&&(window.Faye=Faye),Faye.Class=function(t,e){"function"!=typeof t&&(e=t,t=Object);var n=function(){return this.initialize?this.initialize.apply(this,arguments)||this:this},i=function(){};return i.prototype=t.prototype,n.prototype=new i,Faye.extend(n.prototype,e),n},function(){function t(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0;n<t.length;n++)if(e===t[n])return n;return-1}var e=Faye.EventEmitter=function(){},n="function"==typeof Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};e.prototype.emit=function(t){if("error"===t&&(!this._events||!this._events.error||n(this._events.error)&&!this._events.error.length))throw arguments[1]instanceof Error?arguments[1]:Error("Uncaught, unspecified 'error' event.");if(!this._events)return!1;var e=this._events[t];if(!e)return!1;if("function"==typeof e){switch(arguments.length){case 1:e.call(this);break;case 2:e.call(this,arguments[1]);break;case 3:e.call(this,arguments[1],arguments[2]);break;default:var i=Array.prototype.slice.call(arguments,1);e.apply(this,i)}return!0}if(n(e)){for(var i=Array.prototype.slice.call(arguments,1),r=e.slice(),s=0,o=r.length;o>s;s++)r[s].apply(this,i);return!0}return!1},e.prototype.addListener=function(t,e){if("function"!=typeof e)throw Error("addListener only takes instances of Function");return this._events||(this._events={}),this.emit("newListener",t,e),this._events[t]?n(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,this},e.prototype.on=e.prototype.addListener,e.prototype.once=function(t,e){var n=this;return n.on(t,function i(){n.removeListener(t,i),e.apply(this,arguments)}),this},e.prototype.removeListener=function(e,i){if("function"!=typeof i)throw Error("removeListener only takes instances of Function");if(!this._events||!this._events[e])return this;var r=this._events[e];if(n(r)){var s=t(r,i);if(0>s)return this;r.splice(s,1),0==r.length&&delete this._events[e]}else this._events[e]===i&&delete this._events[e];return this},e.prototype.removeAllListeners=function(t){return 0===arguments.length?(this._events={},this):(t&&this._events&&this._events[t]&&(this._events[t]=null),this)},e.prototype.listeners=function(t){return this._events||(this._events={}),this._events[t]||(this._events[t]=[]),n(this._events[t])||(this._events[t]=[this._events[t]]),this._events[t]}}(),Faye.Namespace=Faye.Class({initialize:function(){this._used={}},exists:function(t){return this._used.hasOwnProperty(t)},generate:function(){for(var t=Faye.random();this._used.hasOwnProperty(t);)t=Faye.random();return this._used[t]=t},release:function(t){delete this._used[t]}}),function(){var t,e=setTimeout;t="function"==typeof setImmediate?function(t){setImmediate(t)}:"object"==typeof process&&process.nextTick?function(t){process.nextTick(t)
}:function(t){e(t,0)};var n=0,i=1,r=2,s=function(t){return t},o=function(t){throw t},a=function(t){if(this._state=n,this._callbacks=[],this._errbacks=[],"function"==typeof t){var e=this;t(function(t){p(e,t)},function(t){f(e,t)})}};a.prototype.then=function(t,e){var n={},i=this;return n.promise=new a(function(r,s){n.fulfill=r,n.reject=s,u(i,t,n),c(i,e,n)}),n.promise};var u=function(t,e,r){"function"!=typeof e&&(e=s);var o=function(t){l(e,t,r)};t._state===n?t._callbacks.push(o):t._state===i&&o(t._value)},c=function(t,e,i){"function"!=typeof e&&(e=o);var s=function(t){l(e,t,i)};t._state===n?t._errbacks.push(s):t._state===r&&s(t._reason)},l=function(e,n,i){t(function(){h(e,n,i)})},h=function(t,e,n){var i,r,o,a=!1;try{if(i=t(e),r=typeof i,o=null!==i&&("function"===r||"object"===r)&&i.then,i===n.promise)return n.reject(new TypeError("Recursive promise chain detected"));if("function"!=typeof o)return n.fulfill(i);o.call(i,function(t){a||(a=!0,h(s,t,n))},function(t){a||(a=!0,n.reject(t))})}catch(u){if(a)return;a=!0,n.reject(u)}},p=a.fulfill=a.resolve=function(t,e){if(t._state===n){t._state=i,t._value=e,t._errbacks=[];for(var r,s=t._callbacks;r=s.shift();)r(e)}},f=a.reject=function(t,e){if(t._state===n){t._state=r,t._reason=e,t._callbacks=[];for(var i,s=t._errbacks;i=s.shift();)i(e)}};a.defer=t,a.deferred=a.pending=function(){var t={};return t.promise=new a(function(e,n){t.fulfill=t.resolve=e,t.reject=n}),t},a.fulfilled=a.resolved=function(t){return new a(function(e){e(t)})},a.rejected=function(t){return new a(function(e,n){n(t)})},void 0===Faye?module.exports=a:Faye.Promise=a}(),Faye.Set=Faye.Class({initialize:function(){this._index={}},add:function(t){var e=void 0!==t.id?t.id:t;return this._index.hasOwnProperty(e)?!1:(this._index[e]=t,!0)},forEach:function(t,e){for(var n in this._index)this._index.hasOwnProperty(n)&&t.call(e,this._index[n])},isEmpty:function(){for(var t in this._index)if(this._index.hasOwnProperty(t))return!1;return!0},member:function(t){for(var e in this._index)if(this._index[e]===t)return!0;return!1},remove:function(t){var e=void 0!==t.id?t.id:t,n=this._index[e];return delete this._index[e],n},toArray:function(){var t=[];return this.forEach(function(e){t.push(e)}),t}}),Faye.URI={isURI:function(t){return t&&t.protocol&&t.host&&t.path},isSameOrigin:function(t){var e=Faye.ENV.location;return t.protocol===e.protocol&&t.hostname===e.hostname&&t.port===e.port},parse:function(t){if("string"!=typeof t)return t;var e,n,i,r,s,o,a={},u=function(e,n){t=t.replace(n,function(t){return a[e]=t,""}),a[e]=a[e]||""};for(u("protocol",/^[a-z]+\:/i),u("host",/^\/\/[^\/\?#]+/),/^\//.test(t)||a.host||(t=Faye.ENV.location.pathname.replace(/[^\/]*$/,"")+t),u("pathname",/^[^\?#]*/),u("search",/^\?[^#]*/),u("hash",/^#.*/),a.protocol=a.protocol||Faye.ENV.location.protocol,a.host?(a.host=a.host.substr(2),e=a.host.split(":"),a.hostname=e[0],a.port=e[1]||""):(a.host=Faye.ENV.location.host,a.hostname=Faye.ENV.location.hostname,a.port=Faye.ENV.location.port),a.pathname=a.pathname||"/",a.path=a.pathname+a.search,n=a.search.replace(/^\?/,""),i=n?n.split("&"):[],o={},r=0,s=i.length;s>r;r++)e=i[r].split("="),o[decodeURIComponent(e[0]||"")]=decodeURIComponent(e[1]||"");return a.query=o,a.href=this.stringify(a),a},stringify:function(t){var e=t.protocol+"//"+t.hostname;return t.port&&(e+=":"+t.port),e+=t.pathname+this.queryString(t.query)+(t.hash||"")},queryString:function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return 0===e.length?"":"?"+e.join("&")}},Faye.Error=Faye.Class({initialize:function(t,e,n){this.code=t,this.params=Array.prototype.slice.call(e),this.message=n},toString:function(){return this.code+":"+this.params.join(",")+":"+this.message}}),Faye.Error.parse=function(t){if(t=t||"",!Faye.Grammar.ERROR.test(t))return new this(null,[],t);var e=t.split(":"),n=parseInt(e[0]),i=e[1].split(","),t=e[2];return new this(n,i,t)},Faye.Error.versionMismatch=function(){return""+new this(300,arguments,"Version mismatch")},Faye.Error.conntypeMismatch=function(){return""+new this(301,arguments,"Connection types not supported")},Faye.Error.extMismatch=function(){return""+new this(302,arguments,"Extension mismatch")},Faye.Error.badRequest=function(){return""+new this(400,arguments,"Bad request")},Faye.Error.clientUnknown=function(){return""+new this(401,arguments,"Unknown client")},Faye.Error.parameterMissing=function(){return""+new this(402,arguments,"Missing required parameter")},Faye.Error.channelForbidden=function(){return""+new this(403,arguments,"Forbidden channel")},Faye.Error.channelUnknown=function(){return""+new this(404,arguments,"Unknown channel")},Faye.Error.channelInvalid=function(){return""+new this(405,arguments,"Invalid channel")},Faye.Error.extUnknown=function(){return""+new this(406,arguments,"Unknown extension")},Faye.Error.publishFailed=function(){return""+new this(407,arguments,"Failed to publish")},Faye.Error.serverError=function(){return""+new this(500,arguments,"Internal server error")},Faye.Deferrable={then:function(t,e){var n=this;return this._promise||(this._promise=new Faye.Promise(function(t,e){n._fulfill=t,n._reject=e})),0===arguments.length?this._promise:this._promise.then(t,e)},callback:function(t,e){return this.then(function(n){t.call(e,n)})},errback:function(t,e){return this.then(null,function(n){t.call(e,n)})},timeout:function(t,e){this.then();var n=this;this._timer=Faye.ENV.setTimeout(function(){n._reject(e)},1e3*t)},setDeferredStatus:function(t,e){this._timer&&Faye.ENV.clearTimeout(this._timer),this.then(),"succeeded"===t?this._fulfill(e):"failed"===t?this._reject(e):delete this._promise}},Faye.Publisher={countListeners:function(t){return this.listeners(t).length},bind:function(t,e,n){var i=Array.prototype.slice,r=function(){e.apply(n,i.call(arguments))};return this._listeners=this._listeners||[],this._listeners.push([t,e,n,r]),this.on(t,r)},unbind:function(t,e,n){this._listeners=this._listeners||[];for(var i,r=this._listeners.length;r--;)i=this._listeners[r],i[0]===t&&(!e||i[1]===e&&i[2]===n)&&(this._listeners.splice(r,1),this.removeListener(t,i[3]))}},Faye.extend(Faye.Publisher,Faye.EventEmitter.prototype),Faye.Publisher.trigger=Faye.Publisher.emit,Faye.Timeouts={addTimeout:function(t,e,n,i){if(this._timeouts=this._timeouts||{},!this._timeouts.hasOwnProperty(t)){var r=this;this._timeouts[t]=Faye.ENV.setTimeout(function(){delete r._timeouts[t],n.call(i)},1e3*e)}},removeTimeout:function(t){this._timeouts=this._timeouts||{};var e=this._timeouts[t];e&&(clearTimeout(e),delete this._timeouts[t])},removeAllTimeouts:function(){this._timeouts=this._timeouts||{};for(var t in this._timeouts)this.removeTimeout(t)}},Faye.Logging={LOG_LEVELS:{fatal:4,error:3,warn:2,info:1,debug:0},writeLog:function(t,e){if(Faye.logger){var t=Array.prototype.slice.apply(t),n="[Faye",i=this.className,r=t.shift().replace(/\?/g,function(){try{return Faye.toJSON(t.shift())}catch(e){return"[Object]"}});for(var s in Faye)i||"function"==typeof Faye[s]&&this instanceof Faye[s]&&(i=s);i&&(n+="."+i),n+="] ","function"==typeof Faye.logger[e]?Faye.logger[e](n+r):"function"==typeof Faye.logger&&Faye.logger(n+r)}}},function(){for(var t in Faye.Logging.LOG_LEVELS)(function(t){Faye.Logging[t]=function(){this.writeLog(arguments,t)}})(t,Faye.Logging.LOG_LEVELS[t])}(),Faye.Grammar={CHANNEL_NAME:/^\/(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)))+(\/(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)))+)*$/,CHANNEL_PATTERN:/^(\/(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)))+)*\/\*{1,2}$/,ERROR:/^([0-9][0-9][0-9]:(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*(,(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*)*:(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*|[0-9][0-9][0-9]::(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*)$/,VERSION:/^([0-9])+(\.(([a-z]|[A-Z])|[0-9])(((([a-z]|[A-Z])|[0-9])|\-|\_))*)*$/},Faye.Extensible={addExtension:function(t){this._extensions=this._extensions||[],this._extensions.push(t),t.added&&t.added(this)},removeExtension:function(t){if(this._extensions)for(var e=this._extensions.length;e--;)this._extensions[e]===t&&(this._extensions.splice(e,1),t.removed&&t.removed(this))},pipeThroughExtensions:function(t,e,n,i,r){if(this.debug("Passing through ? extensions: ?",t,e),!this._extensions)return i.call(r,e);var s=this._extensions.slice(),o=function(e){if(!e)return i.call(r,e);var a=s.shift();if(!a)return i.call(r,e);var u=a[t];return u?void(u.length>=3?a[t](e,n,o):a[t](e,o)):o(e)};o(e)}},Faye.extend(Faye.Extensible,Faye.Logging),Faye.Channel=Faye.Class({initialize:function(t){this.id=this.name=t},push:function(t){this.trigger("message",t)},isUnused:function(){return 0===this.countListeners("message")}}),Faye.extend(Faye.Channel.prototype,Faye.Publisher),Faye.extend(Faye.Channel,{HANDSHAKE:"/meta/handshake",CONNECT:"/meta/connect",SUBSCRIBE:"/meta/subscribe",UNSUBSCRIBE:"/meta/unsubscribe",DISCONNECT:"/meta/disconnect",META:"meta",SERVICE:"service",expand:function(t){var e=this.parse(t),n=["/**",t],i=e.slice();i[i.length-1]="*",n.push(this.unparse(i));for(var r=1,s=e.length;s>r;r++)i=e.slice(0,r),i.push("**"),n.push(this.unparse(i));return n},isValid:function(t){return Faye.Grammar.CHANNEL_NAME.test(t)||Faye.Grammar.CHANNEL_PATTERN.test(t)},parse:function(t){return this.isValid(t)?t.split("/").slice(1):null},unparse:function(t){return"/"+t.join("/")},isMeta:function(t){var e=this.parse(t);return e?e[0]===this.META:null},isService:function(t){var e=this.parse(t);return e?e[0]===this.SERVICE:null},isSubscribable:function(t){return this.isValid(t)?!this.isMeta(t)&&!this.isService(t):null},Set:Faye.Class({initialize:function(){this._channels={}},getKeys:function(){var t=[];for(var e in this._channels)t.push(e);return t},remove:function(t){delete this._channels[t]},hasSubscription:function(t){return this._channels.hasOwnProperty(t)},subscribe:function(t,e,n){if(e)for(var i,r=0,s=t.length;s>r;r++){i=t[r];var o=this._channels[i]=this._channels[i]||new Faye.Channel(i);o.bind("message",e,n)}},unsubscribe:function(t,e,n){var i=this._channels[t];return i?(i.unbind("message",e,n),i.isUnused()?(this.remove(t),!0):!1):!1},distributeMessage:function(t){for(var e=Faye.Channel.expand(t.channel),n=0,i=e.length;i>n;n++){var r=this._channels[e[n]];r&&r.trigger("message",t.data)}}})}),Faye.Envelope=Faye.Class({initialize:function(t,e){this.id=t.id,this.message=t,void 0!==e&&this.timeout(e/1e3,!1)}}),Faye.extend(Faye.Envelope.prototype,Faye.Deferrable),Faye.Publication=Faye.Class(Faye.Deferrable),Faye.Subscription=Faye.Class({initialize:function(t,e,n,i){this._client=t,this._channels=e,this._callback=n,this._context=i,this._cancelled=!1},cancel:function(){this._cancelled||(this._client.unsubscribe(this._channels,this._callback,this._context),this._cancelled=!0)},unsubscribe:function(){this.cancel()}}),Faye.extend(Faye.Subscription.prototype,Faye.Deferrable),Faye.Client=Faye.Class({UNCONNECTED:1,CONNECTING:2,CONNECTED:3,DISCONNECTED:4,HANDSHAKE:"handshake",RETRY:"retry",NONE:"none",CONNECTION_TIMEOUT:60,DEFAULT_RETRY:5,MAX_REQUEST_SIZE:2048,DEFAULT_ENDPOINT:"/bayeux",INTERVAL:0,initialize:function(t,e){this.info("New client created for ?",t),this._options=e||{},this.endpoint=Faye.URI.parse(t||this.DEFAULT_ENDPOINT),this.endpoints=this._options.endpoints||{},this.transports={},this.cookies=Faye.CookieJar&&new Faye.CookieJar,this.headers={},this.ca=this._options.ca,this._disabled=[],this._retry=this._options.retry||this.DEFAULT_RETRY;for(var n in this.endpoints)this.endpoints[n]=Faye.URI.parse(this.endpoints[n]);this.maxRequestSize=this.MAX_REQUEST_SIZE,this._state=this.UNCONNECTED,this._channels=new Faye.Channel.Set,this._messageId=0,this._responseCallbacks={},this._advice={reconnect:this.RETRY,interval:1e3*(this._options.interval||this.INTERVAL),timeout:1e3*(this._options.timeout||this.CONNECTION_TIMEOUT)},Faye.Event&&void 0!==Faye.ENV.onbeforeunload&&Faye.Event.on(Faye.ENV,"beforeunload",function(){Faye.indexOf(this._disabled,"autodisconnect")<0&&this.disconnect()},this)},disable:function(t){this._disabled.push(t)},setHeader:function(t,e){this.headers[t]=e},handshake:function(t,e){if(this._advice.reconnect!==this.NONE&&this._state===this.UNCONNECTED){this._state=this.CONNECTING;var n=this;this.info("Initiating handshake with ?",Faye.URI.stringify(this.endpoint)),this._selectTransport(Faye.MANDATORY_CONNECTION_TYPES),this._send({channel:Faye.Channel.HANDSHAKE,version:Faye.BAYEUX_VERSION,supportedConnectionTypes:[this._transport.connectionType]},function(i){i.successful?(this._state=this.CONNECTED,this._clientId=i.clientId,this._selectTransport(i.supportedConnectionTypes),this.info("Handshake successful: ?",this._clientId),this.subscribe(this._channels.getKeys(),!0),t&&Faye.Promise.defer(function(){t.call(e)})):(this.info("Handshake unsuccessful"),Faye.ENV.setTimeout(function(){n.handshake(t,e)},this._advice.interval),this._state=this.UNCONNECTED)},this)}},connect:function(t,e){if(this._advice.reconnect!==this.NONE&&this._state!==this.DISCONNECTED){if(this._state===this.UNCONNECTED)return this.handshake(function(){this.connect(t,e)},this);this.callback(t,e),this._state===this.CONNECTED&&(this.info("Calling deferred actions for ?",this._clientId),this.setDeferredStatus("succeeded"),this.setDeferredStatus("unknown"),this._connectRequest||(this._connectRequest=!0,this.info("Initiating connection for ?",this._clientId),this._send({channel:Faye.Channel.CONNECT,clientId:this._clientId,connectionType:this._transport.connectionType},this._cycleConnection,this)))}},disconnect:function(){this._state===this.CONNECTED&&(this._state=this.DISCONNECTED,this.info("Disconnecting ?",this._clientId),this._send({channel:Faye.Channel.DISCONNECT,clientId:this._clientId},function(t){t.successful&&(this._transport.close(),delete this._transport)},this),this.info("Clearing channel listeners for ?",this._clientId),this._channels=new Faye.Channel.Set)},subscribe:function(t,e,n){if(t instanceof Array)return Faye.map(t,function(t){return this.subscribe(t,e,n)},this);var i=new Faye.Subscription(this,t,e,n),r=e===!0,s=this._channels.hasSubscription(t);return s&&!r?(this._channels.subscribe([t],e,n),i.setDeferredStatus("succeeded"),i):(this.connect(function(){this.info("Client ? attempting to subscribe to ?",this._clientId,t),r||this._channels.subscribe([t],e,n),this._send({channel:Faye.Channel.SUBSCRIBE,clientId:this._clientId,subscription:t},function(r){if(!r.successful)return i.setDeferredStatus("failed",Faye.Error.parse(r.error)),this._channels.unsubscribe(t,e,n);var s=[].concat(r.subscription);this.info("Subscription acknowledged for ? to ?",this._clientId,s),i.setDeferredStatus("succeeded")},this)},this),i)},unsubscribe:function(t,e,n){if(t instanceof Array)return Faye.map(t,function(t){return this.unsubscribe(t,e,n)},this);var i=this._channels.unsubscribe(t,e,n);i&&this.connect(function(){this.info("Client ? attempting to unsubscribe from ?",this._clientId,t),this._send({channel:Faye.Channel.UNSUBSCRIBE,clientId:this._clientId,subscription:t},function(t){if(t.successful){var e=[].concat(t.subscription);this.info("Unsubscription acknowledged for ? from ?",this._clientId,e)}},this)},this)},publish:function(t,e){var n=new Faye.Publication;return this.connect(function(){this.info("Client ? queueing published message to ?: ?",this._clientId,t,e),this._send({channel:t,data:e,clientId:this._clientId},function(t){t.successful?n.setDeferredStatus("succeeded"):n.setDeferredStatus("failed",Faye.Error.parse(t.error))},this)},this),n},receiveMessage:function(t){var e,n=t.id;void 0!==t.successful&&(e=this._responseCallbacks[n],delete this._responseCallbacks[n]),this.pipeThroughExtensions("incoming",t,null,function(t){t&&(t.advice&&this._handleAdvice(t.advice),this._deliverMessage(t),e&&e[0].call(e[1],t))},this),this._transportUp!==!0&&(this._transportUp=!0,this.trigger("transport:up"))},messageError:function(t,e){for(var n,i,r=this._retry,s=this,o=0,a=t.length;a>o;o++)i=t[o],n=i.id,e?this._transportSend(i):Faye.ENV.setTimeout(function(){s._transportSend(i)},1e3*r);e||this._transportUp===!1||(this._transportUp=!1,this.trigger("transport:down"))},_selectTransport:function(t){Faye.Transport.get(this,t,this._disabled,function(t){this.debug("Selected ? transport for ?",t.connectionType,Faye.URI.stringify(t.endpoint)),t!==this._transport&&(this._transport&&this._transport.close(),this._transport=t)},this)},_send:function(t,e,n){this._transport&&(t.id=t.id||this._generateMessageId(),this.pipeThroughExtensions("outgoing",t,null,function(t){t&&(e&&(this._responseCallbacks[t.id]=[e,n]),this._transportSend(t))},this))},_transportSend:function(t){if(this._transport){var e=1.2*(this._advice.timeout||1e3*this._retry),n=new Faye.Envelope(t,e);n.errback(function(e){this.messageError([t],e)},this),this._transport.send(n)}},_generateMessageId:function(){return this._messageId+=1,this._messageId>=Math.pow(2,32)&&(this._messageId=0),this._messageId.toString(36)},_handleAdvice:function(t){Faye.extend(this._advice,t),this._advice.reconnect===this.HANDSHAKE&&this._state!==this.DISCONNECTED&&(this._state=this.UNCONNECTED,this._clientId=null,this._cycleConnection())},_deliverMessage:function(t){t.channel&&void 0!==t.data&&(this.info("Client ? calling listeners for ? with ?",this._clientId,t.channel,t.data),this._channels.distributeMessage(t))},_cycleConnection:function(){this._connectRequest&&(this._connectRequest=null,this.info("Closed connection for ?",this._clientId));var t=this;Faye.ENV.setTimeout(function(){t.connect()},this._advice.interval)}}),Faye.extend(Faye.Client.prototype,Faye.Deferrable),Faye.extend(Faye.Client.prototype,Faye.Publisher),Faye.extend(Faye.Client.prototype,Faye.Logging),Faye.extend(Faye.Client.prototype,Faye.Extensible),Faye.Transport=Faye.extend(Faye.Class({MAX_DELAY:0,batching:!0,initialize:function(t,e){this._client=t,this.endpoint=e,this._outbox=[]},close:function(){},encode:function(){return""},send:function(t){var e=t.message;return this.debug("Client ? sending message to ?: ?",this._client._clientId,Faye.URI.stringify(this.endpoint),e),this.batching?(this._outbox.push(t),e.channel===Faye.Channel.HANDSHAKE?this.addTimeout("publish",.01,this.flush,this):(e.channel===Faye.Channel.CONNECT&&(this._connectMessage=e),this.flushLargeBatch(),void this.addTimeout("publish",this.MAX_DELAY,this.flush,this))):this.request([t])},flush:function(){this.removeTimeout("publish"),this._outbox.length>1&&this._connectMessage&&(this._connectMessage.advice={timeout:0}),this.request(this._outbox),this._connectMessage=null,this._outbox=[]},flushLargeBatch:function(){var t=this.encode(this._outbox);if(!(t.length<this._client.maxRequestSize)){var e=this._outbox.pop();this.flush(),e&&this._outbox.push(e)}},receive:function(t,e){for(var n=t.length;n--;)t[n].setDeferredStatus("succeeded");e=[].concat(e),this.debug("Client ? received from ?: ?",this._client._clientId,Faye.URI.stringify(this.endpoint),e);for(var i=0,n=e.length;n>i;i++)this._client.receiveMessage(e[i])},handleError:function(t,e){for(var n=t.length;n--;)t[n].setDeferredStatus("failed",e)},_getCookies:function(){var t=this._client.cookies;return t?t.getCookies({domain:this.endpoint.hostname,path:this.endpoint.path,secure:"https:"===this.endpoint.protocol}).toValueString():""},_storeCookies:function(t){if(t&&this._client.cookies){t=[].concat(t);for(var e,n=0,i=t.length;i>n;n++)e=this._client.cookies.setCookie(t[n]),e=e[0]||e,e.domain=e.domain||this.endpoint.hostname}}}),{get:function(t,e,n,i,r){var s=t.endpoint;Faye.asyncEach(this._transports,function(o,a){var u=o[0],c=o[1],l=t.endpoints[u]||s;return Faye.indexOf(n,u)>=0?a():Faye.indexOf(e,u)<0?(c.isUsable(t,l,function(){}),a()):void c.isUsable(t,l,function(e){if(!e)return a();var n=c.hasOwnProperty("create")?c.create(t,l):new c(t,l);i.call(r,n)})},function(){throw Error("Could not find a usable connection type for "+Faye.URI.stringify(s))})},register:function(t,e){this._transports.push([t,e]),e.prototype.connectionType=t},_transports:[]}),Faye.extend(Faye.Transport.prototype,Faye.Logging),Faye.extend(Faye.Transport.prototype,Faye.Timeouts),Faye.Event={_registry:[],on:function(t,e,n,i){var r=function(){n.call(i)};t.addEventListener?t.addEventListener(e,r,!1):t.attachEvent("on"+e,r),this._registry.push({_element:t,_type:e,_callback:n,_context:i,_handler:r})},detach:function(t,e,n,i){for(var r,s=this._registry.length;s--;)r=this._registry[s],t&&t!==r._element||e&&e!==r._type||n&&n!==r._callback||i&&i!==r._context||(r._element.removeEventListener?r._element.removeEventListener(r._type,r._handler,!1):r._element.detachEvent("on"+r._type,r._handler),this._registry.splice(s,1),r=null)}},void 0!==Faye.ENV.onunload&&Faye.Event.on(Faye.ENV,"unload",Faye.Event.detach,Faye.Event),"object"!=typeof JSON&&(JSON={}),function(){function f(t){return 10>t?"0"+t:t}function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var n,i,r,s,o,a=gap,u=e[t];switch(u&&"object"==typeof u&&"function"==typeof u.toJSON&&(u=u.toJSON(t)),"function"==typeof rep&&(u=rep.call(e,t,u)),typeof u){case"string":return quote(u);case"number":return isFinite(u)?u+"":"null";case"boolean":case"null":return u+"";case"object":if(!u)return"null";if(gap+=indent,o=[],"[object Array]"===Object.prototype.toString.apply(u)){for(s=u.length,n=0;s>n;n+=1)o[n]=str(n,u)||"null";return r=0===o.length?"[]":gap?"[\n"+gap+o.join(",\n"+gap)+"\n"+a+"]":"["+o.join(",")+"]",gap=a,r}if(rep&&"object"==typeof rep)for(s=rep.length,n=0;s>n;n+=1)"string"==typeof rep[n]&&(i=rep[n],r=str(i,u),r&&o.push(quote(i)+(gap?": ":":")+r));else for(i in u)Object.prototype.hasOwnProperty.call(u,i)&&(r=str(i,u),r&&o.push(quote(i)+(gap?": ":":")+r));return r=0===o.length?"{}":gap?"{\n"+gap+o.join(",\n"+gap)+"\n"+a+"}":"{"+o.join(",")+"}",gap=a,r}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;Faye.stringify=function(t,e,n){var i;if(gap="",indent="","number"==typeof n)for(i=0;n>i;i+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=e,e&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw Error("JSON.stringify");return str("",{"":t})},"function"!=typeof JSON.stringify&&(JSON.stringify=Faye.stringify),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(t,e){var n,i,r=t[e];if(r&&"object"==typeof r)for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(i=walk(r,n),void 0!==i?r[n]=i:delete r[n]);return reviver.call(t,e,r)}var j;if(text+="",cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),Faye.Transport.WebSocket=Faye.extend(Faye.Class(Faye.Transport,{UNCONNECTED:1,CONNECTING:2,CONNECTED:3,batching:!1,isUsable:function(t,e){this.callback(function(){t.call(e,!0)}),this.errback(function(){t.call(e,!1)}),this.connect()},request:function(t){this._pending=this._pending||new Faye.Set;for(var e=0,n=t.length;n>e;e++)this._pending.add(t[e]);this.callback(function(e){if(e){var n=Faye.map(t,function(t){return t.message});e.send(Faye.toJSON(n))}},this),this.connect()},connect:function(){if(!Faye.Transport.WebSocket._unloaded&&(this._state=this._state||this.UNCONNECTED,this._state===this.UNCONNECTED)){this._state=this.CONNECTING;var t=this._createSocket();if(!t)return this.setDeferredStatus("failed");var e=this;t.onopen=function(){t.headers&&e._storeCookies(t.headers["set-cookie"]),e._socket=t,e._state=e.CONNECTED,e._everConnected=!0,e._ping(),e.setDeferredStatus("succeeded",t)};var n=!1;t.onclose=t.onerror=function(){if(!n){n=!0;var i=e._state===e.CONNECTED;t.onopen=t.onclose=t.onerror=t.onmessage=null,delete e._socket,e._state=e.UNCONNECTED,e.removeTimeout("ping"),e.setDeferredStatus("unknown");var r=e._pending?e._pending.toArray():[];delete e._pending,i?e.handleError(r,!0):e._everConnected?e.handleError(r):e.setDeferredStatus("failed")}},t.onmessage=function(t){var n,i=JSON.parse(t.data),r=[];if(i){i=[].concat(i);for(var s=0,o=i.length;o>s;s++)void 0!==i[s].successful&&(n=e._pending.remove(i[s]),n&&r.push(n));e.receive(r,i)}}}},close:function(){this._socket&&this._socket.close()},_createSocket:function(){var t=Faye.Transport.WebSocket.getSocketUrl(this.endpoint),e={headers:Faye.copyObject(this._client.headers),ca:this._client.ca};return e.headers.Cookie=this._getCookies(),Faye.WebSocket?new Faye.WebSocket.Client(t,[],e):Faye.ENV.MozWebSocket?new MozWebSocket(t):Faye.ENV.WebSocket?new WebSocket(t):void 0},_ping:function(){this._socket&&(this._socket.send("[]"),this.addTimeout("ping",this._client._advice.timeout/2e3,this._ping,this))}}),{PROTOCOLS:{"http:":"ws:","https:":"wss:"},create:function(t,e){var n=t.transports.websocket=t.transports.websocket||{};return n[e.href]=n[e.href]||new this(t,e),n[e.href]},getSocketUrl:function(t){return t=Faye.copyObject(t),t.protocol=this.PROTOCOLS[t.protocol],Faye.URI.stringify(t)},isUsable:function(t,e,n,i){this.create(t,e).isUsable(n,i)}}),Faye.extend(Faye.Transport.WebSocket.prototype,Faye.Deferrable),Faye.Transport.register("websocket",Faye.Transport.WebSocket),Faye.Event&&Faye.Event.on(Faye.ENV,"beforeunload",function(){Faye.Transport.WebSocket._unloaded=!0}),Faye.Transport.EventSource=Faye.extend(Faye.Class(Faye.Transport,{initialize:function(t,e){if(Faye.Transport.prototype.initialize.call(this,t,e),!Faye.ENV.EventSource)return this.setDeferredStatus("failed");this._xhr=new Faye.Transport.XHR(t,e),e=Faye.copyObject(e),e.pathname+="/"+t._clientId;var n=new EventSource(Faye.URI.stringify(e)),i=this;n.onopen=function(){i._everConnected=!0,i.setDeferredStatus("succeeded")},n.onerror=function(){i._everConnected?i._client.messageError([]):(i.setDeferredStatus("failed"),n.close())},n.onmessage=function(t){i.receive([],JSON.parse(t.data))},this._socket=n},close:function(){this._socket&&(this._socket.onopen=this._socket.onerror=this._socket.onmessage=null,this._socket.close(),delete this._socket)},isUsable:function(t,e){this.callback(function(){t.call(e,!0)}),this.errback(function(){t.call(e,!1)})},encode:function(t){return this._xhr.encode(t)},request:function(t){this._xhr.request(t)}}),{isUsable:function(t,e,n,i){var r=t._clientId;return r?void Faye.Transport.XHR.isUsable(t,e,function(r){return r?void this.create(t,e).isUsable(n,i):n.call(i,!1)},this):n.call(i,!1)},create:function(t,e){var n=t.transports.eventsource=t.transports.eventsource||{},i=t._clientId;e=Faye.copyObject(e),e.pathname+="/"+(i||"");var r=Faye.URI.stringify(e);return n[r]=n[r]||new this(t,e),n[r]}}),Faye.extend(Faye.Transport.EventSource.prototype,Faye.Deferrable),Faye.Transport.register("eventsource",Faye.Transport.EventSource),Faye.Transport.XHR=Faye.extend(Faye.Class(Faye.Transport,{encode:function(t){var e=Faye.map(t,function(t){return t.message});return Faye.toJSON(e)},request:function(t){var e=this.endpoint.path,n=Faye.ENV.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest,i=this;n.open("POST",e,!0),n.setRequestHeader("Content-Type","application/json"),n.setRequestHeader("Pragma","no-cache"),n.setRequestHeader("X-Requested-With","XMLHttpRequest");var r=this._client.headers;for(var s in r)r.hasOwnProperty(s)&&n.setRequestHeader(s,r[s]);var o=function(){n.abort()};Faye.Event.on(Faye.ENV,"beforeunload",o),n.onreadystatechange=function(){if(n&&4===n.readyState){var e=null,r=n.status,s=n.responseText,a=r>=200&&300>r||304===r||1223===r;if(Faye.Event.detach(Faye.ENV,"beforeunload",o),n.onreadystatechange=function(){},n=null,!a)return i.handleError(t);try{e=JSON.parse(s)}catch(u){}e?i.receive(t,e):i.handleError(t)}},n.send(this.encode(t))}}),{isUsable:function(t,e,n,i){n.call(i,Faye.URI.isSameOrigin(e))}}),Faye.Transport.register("long-polling",Faye.Transport.XHR),Faye.Transport.CORS=Faye.extend(Faye.Class(Faye.Transport,{encode:function(t){var e=Faye.map(t,function(t){return t.message});return"message="+encodeURIComponent(Faye.toJSON(e))},request:function(t){var e,n=Faye.ENV.XDomainRequest?XDomainRequest:XMLHttpRequest,i=new n,r=this._client.headers,s=this;if(i.open("POST",Faye.URI.stringify(this.endpoint),!0),i.setRequestHeader){i.setRequestHeader("Pragma","no-cache");for(e in r)r.hasOwnProperty(e)&&i.setRequestHeader(e,r[e])}var o=function(){return i?(i.onload=i.onerror=i.ontimeout=i.onprogress=null,void(i=null)):!1};i.onload=function(){var e=null;try{e=JSON.parse(i.responseText)}catch(n){}o(),e?s.receive(t,e):s.handleError(t)},i.onerror=i.ontimeout=function(){o(),s.handleError(t)},i.onprogress=function(){},i.send(this.encode(t))}}),{isUsable:function(t,e,n,i){if(Faye.URI.isSameOrigin(e))return n.call(i,!1);if(Faye.ENV.XDomainRequest)return n.call(i,e.protocol===Faye.ENV.location.protocol);if(Faye.ENV.XMLHttpRequest){var r=new Faye.ENV.XMLHttpRequest;return n.call(i,void 0!==r.withCredentials)}return n.call(i,!1)}}),Faye.Transport.register("cross-origin-long-polling",Faye.Transport.CORS),Faye.Transport.JSONP=Faye.extend(Faye.Class(Faye.Transport,{encode:function(t){var e=Faye.map(t,function(t){return t.message}),n=Faye.copyObject(this.endpoint);return n.query.message=Faye.toJSON(e),n.query.jsonp="__jsonp"+Faye.Transport.JSONP._cbCount+"__",Faye.URI.stringify(n)},request:function(t){var e=Faye.map(t,function(t){return t.message}),n=document.getElementsByTagName("head")[0],i=document.createElement("script"),r=Faye.Transport.JSONP.getCallbackName(),s=Faye.copyObject(this.endpoint),o=this;s.query.message=Faye.toJSON(e),s.query.jsonp=r,Faye.ENV[r]=function(e){if(!Faye.ENV[r])return!1;Faye.ENV[r]=void 0;try{delete Faye.ENV[r]}catch(n){}i.parentNode.removeChild(i),o.receive(t,e)},i.type="text/javascript",i.src=Faye.URI.stringify(s),n.appendChild(i)}}),{_cbCount:0,getCallbackName:function(){return this._cbCount+=1,"__jsonp"+this._cbCount+"__"},isUsable:function(t,e,n,i){n.call(i,!0)}}),Faye.Transport.register("callback-polling",Faye.Transport.JSONP)}()}(this),function(){!function(t){"use strict";var e,n;return e=t.pi=t.pi||{},n=e.utils,e.routes={index:{path:"/api/:collection",method:"get"},edit:{path:"/api/:collection/:id/edit",method:"get"},show:{path:"/api/:collection/:id",method:"get"},create:{path:"/api/:collection",method:"post"},update:{path:"/api/:collection/:id",method:"patch"},destroy:{path:"/api/:collection/:id",method:"delete"},participants:{path:"/api/:collection/:id/participants",method:"get"}}}(this)}.call(this),function(){var t={}.hasOwnProperty;!function(e){"use strict";var n,i,r,s,o,a,u;for(i=e.pi=e.pi||{},r=i.utils,i.net={request:function(n,i,r,s){return null==s&&(s=null),new Promise(function(o,a){var u,c,l,h,p,f;if(l=s||new XMLHttpRequest,f={"X-CSRF-Token":e.AUTH_TOKEN},"GET"===n){if(c=[],null!=r)for(u in r)t.call(r,u)&&(h=r[u],c.push(""+u+"="+encodeURIComponent(h)));i+="?"+c.join("&"),r=null}else f["Content-Type"]="application/json",null!=r&&(r=JSON.stringify(r));l.open(n,i,!0);for(u in f)t.call(f,u)&&(p=f[u],l.setRequestHeader(u,p));return f=null,l.onreadystatechange=function(){var t,e;if(4===l.readyState)return 200===l.status?(e=l.getResponseHeader("Content-Type"),t=/json/.test(e)?JSON.parse(l.responseText):l.responseText,o(t)):a(Error(l.responseText))},l.onerror=function(){a(Error("Network Error"))},l.send(r)})}},a=["get","post","patch","delete"],u=[],s=0,o=a.length;o>s;s++)n=a[s],u.push(i.net[n]=curry(i.net.request,[n.toUpperCase()],null));return u}(this)}.call(this),function(){var t={}.hasOwnProperty;!function(e){"use strict";var n,i;return n=e.pi=e.pi||{},i=n.utils,n.User=function(){function e(e){var n,i;for(n in e)t.call(e,n)&&(i=e[n],this[n]=i);this.fullname=""+(this.name+" "||"")+(this.last_name||"")}return e}()}(this)}.call(this),function(){var t={}.hasOwnProperty,e=[].slice;!function(n){"use strict";
var i,r,s,o,a,u,c,l,h,p,f,d;for(s=n.pi=n.pi||{},o=s.utils,s.controllers||(s.controllers={}),i=null!=Function.prototype.name?function(){return this.constructor.name}:function(){var t,e;return e=/function (.{1,})\(/,t=e.exec(this.constructor.toString()),t[1]},s.utils.Scope=function(){function e(t,e,n){this.whitelist=t,this.blacklist=e,this.rules=null!=n?n:{},this.is_full=!1,this._scope={},this.params={}}return e.prototype._filter_key=function(t){return null!=this.whitelist?this.whitelist.indexOf(t)>-1:null!=this.blacklist?this.blacklist.indexOf(t)<0:!0},e.prototype._merge=function(t,e){return this._scope[t]=this.is_full?this._resolve(t,this._scope[t],e):e},e.prototype._resolve=function(t,e,n){var i,r;return null==this.rules[t]?(this.is_full=!1,n):(r="function"==typeof(i=this.rules)[t]?i[t](e,n):void 0,r===!1?(this.is_full=!1,n):r)},e.prototype.set=function(e){var n,i,r,s;null==e&&(e={});for(n in e)t.call(e,n)&&(i=e[n],this._filter_key(n)&&(this.params[n]=i));r=this.params,s=[];for(n in r)i=r[n],s.push(function(t){return function(){return t._scope[n]!==i?t._merge(n,i):void 0}}(this)());return s},e.prototype.clear=function(){return this.params={},this._scope={}},e.prototype.to_s=function(){var t,e,n,i;n=[],i=this._scope;for(t in i)e=i[t],n.push(""+t+"="+e);return n.join("&")},e.prototype.all_loaded=function(){return o.debug("Scope is full: "+this.to_s()),this.is_full=!0},e.prototype.reload=function(){return o.debug("Scope should be reloaded: "+this.to_s()),this.is_full=!1},e}(),s.controllers.Base=function(){function r(e,i,r){var o,a;this._collection_id=e,this._context_id=null!=i?i:"",this._contexts=null!=r?r:{},a=this._contexts;for(o in a)t.call(a,o)&&(n=a[o],n._context_id=o);""!==this._context_id&&(this._contexts[this._context_id]=this),s.event.on("piecified",function(t){return function(){return t.initialize()}}(this))}return r.include=function(){var t,n,i,r,s,o,a,u;for(i=1<=arguments.length?e.call(arguments,0):[],u=[],s=0,o=i.length;o>s;s++){n=i[s],a=n.prototype;for(t in a)r=a[t],this.prototype[t]=r;u.push(n.included(this.prototype))}return u},r.prototype.initialize=function(t){var e,n;return this.view=t,this.context=this,null==this.view&&(e=o.camelCase(this._collection_id),n=this.class_name().replace(e,""),null!=s.views[""+e+n+"View"]&&(this.view=new s.views[""+e+n+"View"])),null==this.view?o.error("View not found: "+e+n+"View"):void 0},r.prototype.class_name=i,r.prototype.switch_context=function(t,e,n){return this.context._context_id!==e?this._contexts[e]?(o.info("context switch: "+t+" -> "+e),this.context=this._contexts[e],this.context.switched(t,n),!0):void o.warning("undefined context: "+e):void 0},r.prototype.switched=function(t,e){var n;return this._from_context=t,this.view.unfreeze(),("function"==typeof this[n="switched_from_"+this._from_context]?this[n](e):0)?void 0:this.switched_from_any(e)},r.prototype.switched_from_any=function(){return!0},r.prototype.switch_to=function(t,e){var n;return(null!=(n=app.page)?n.switch_context(this._context_id,t,e):void 0)?this.view.freeze():void 0},r.prototype.exit=function(t){return this.switch_to(this._from_context,t)},r.prototype._path=function(t,e){var n,i,r;return null==t&&(t="index"),null==e&&(e={}),r=s.routes[t],i=r.path,n=r.method,[i.replace(/:collection/,this._collection_id).replace(/:id/,e.id),n]},r.prototype._default_resolver=function(t){return function(e){return function(n){return e.view[t].call(e.view,n),n}}(this)},r.prototype._action=function(t,e,n){var i,r,a;return null==n&&(n=null),this._loading?void 0:(n||(n=this._default_resolver(t)),e||(e=null!=this._scope&&o.clone(this._scope.params)),e.id||(e.id=this._scope.params.id),a=this._path(t,e),r=a[0],i=a[1],delete e.id,this.loading(!0),s.net[i].call(null,r,e).then(n)["catch"](function(t){return function(e){return t.view.error(e.message)}}(this)).then(function(t){return function(e){return t.loading(!1),e}}(this)))},r.prototype.loading=function(t){return this._loading!==t?(this._loading=t,this.view.loading(t)):void 0},r.prototype["new"]=function(){return this.view["new"]()},r.prototype.reload=function(){return this._scope.reload(),this.index()},r.prototype.goto=function(t,e){return null==e&&(e="_self"),window.open(t,e)},r}(),p=["index","update","create"],a=function(t){return s.controllers.Base.prototype[t]=function(e){return this._action(t,e)}},u=0,l=p.length;l>u;u++)r=p[u],a(r);for(f=["show","edit","destroy"],d=[],c=0,h=f.length;h>c;c++)r=f[c],d.push(function(t){return s.controllers.Base.prototype[t]=function(e){return this._action(t,{id:null!=e.id?e.id:e})}}(r));return d}(this)}.call(this),function(){!function(t){"use strict";var e,n;return e=t.pi=t.pi||{},n=e.utils,e.modules||(e.modules={}),e.modules.Paginated=function(){function t(){}return t.included=function(t){t.index=t.paginate},t.prototype._page_resolver=function(){return function(t){return function(e){return t._next_page=e.pagination.next_page,t._next_page||t._scope.all_loaded(),1===e.pagination.current_page&&t.view.clear(),t.view.index(e),e}}(this)},t.prototype.next_page=function(){var t;return t=n.clone(this._scope.params),t.page=this._next_page||1,this.paginate(t)},t.prototype.paginate=function(t){return this._scope.is_full?void n.debug("Nothing to load: "+this._scope.to_s()):(t||(t=n.clone(this._scope.params)),t.page||(t.page=1),this._action(this._paginate_action||"index",t,this._page_resolver()))},t}()}(this)}.call(this),function(){!function(t){"use strict";var e,n;return e=t.pi=t.pi||{},n=e.utils,e.modules||(e.modules={}),e.modules.Search=function(){function t(){}return t.included=function(t){var e;null!=t.next_page&&(e=t.next_page,t.next_page=function(){return this._scope.params.q?e.call(this).then(function(t){return function(){return t.view.searched(t._scope.params.q)}}(this)):e.call(this)},t.search=t.search_paginate)},t.prototype.search_paginate=function(t){var e;return this._loading?void(this._queued_query=t):(this._queued_query=null,e={q:t},this._scope.set(e),this._scope.is_full?this.view.search(t):(this.view.before_search(),n.debug("last query "+t),this.index().then(function(e){return function(){return e.view.searched(t)}}(this)).then(function(t){return function(){return t._check_queue()}}(this))))},t.prototype.search=function(t){return this._loading?void 0:this.view.search(t)},t.prototype._check_queue=function(){return null!=this._queued_query?this.search(this._queued_query):void 0},t}()}(this)}.call(this),function(){var t={}.hasOwnProperty;!function(e){"use strict";var n,i,r,s,o,a,u;for(i=e.pi=e.pi||{},r=i.utils,i.views||(i.views={}),i.views.Base=function(){function e(t,e){this.components=t,this.global_comps=e,this.components||(this.components=[]),this.global_comps||(this.global_comps=[]),this.global_comps.push("dark_overlay","light_overlay","popup","status_success","status_error"),this.initialize()}return e.prototype.initialize=function(){var t,e,n,i,r,s,o;for(s=this.global_comps,e=0,i=s.length;i>e;e++)t=s[e],this._attach_component(t,!0);for(o=this.components,n=0,r=o.length;r>n;n++)t=o[n],this._attach_component(t);return!0},e.prototype.freeze=function(){var e,n,r,s;r=this.components,s=[];for(e in r)t.call(r,e)&&(n=r[e],s.push(function(){return n instanceof i.Base?(n.__was_enabled=n.enabled,n.disable()):void 0}()));return s},e.prototype.unfreeze=function(){var e,n,r,s;r=this.components,s=[];for(e in r)t.call(r,e)&&(n=r[e],s.push(function(){return n instanceof i.Base?(n.__was_enabled&&n.enable(),delete n.__was_enabled):void 0}()));return s},e.prototype._attach_component=function(t,e){var n,i,r;if(null==e&&(e=!1),"string"!=typeof t){r=[];for(n in t)i=t[n],r.push(function(t){return function(){return t[n]=$("@"+i),e?void 0:t.components[n]=t[n]}}(this)());return r}return this[t]=$("@"+t),e?void 0:this.components[t]=this[t]},e.prototype.loading=function(t){return r.debug("loading is "+t)},e.prototype.success=function(t){return this.status_success.show(t)},e.prototype.error=function(t){return r.error("Error: "+t),this.status_error.show(t)},e}(),a=["index","show","edit","update","create","new","destroy"],u=[],s=0,o=a.length;o>s;s++)n=a[s],u.push(function(t){return i.views.Base.prototype[t]=function(){return!0}}(n));return u}(this)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};!function(t){"use strict";var n,i;return n=t.pi=t.pi||{},i=n.utils,n.views||(n.views={}),n.views.CommonListView=function(t){function n(){n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(){return n.__super__.initialize.apply(this,arguments),this.list.jst_renderer?void 0:this.list.item_renderer=function(t){var e;return e=i.clone(t),e.nod=$(t.nod),e}},n.prototype.loading=function(t){return t?(this.loader.reset(),this.loader.start()):this.loader.stop()},n.prototype.sort=function(t){var e,n;return e=t.sort_by,n=t.order,this.list.sort(e,"asc"===n)},n.prototype.sorted=function(t,e){return this.list.trigger("sort_update",{fields:t,reverse:e})},n.prototype.before_search=function(){return this.list._start_search()},n.prototype.search=function(t){return this.list.search(t,!0)},n.prototype.searched=function(t){return i.debug("loaded search "+t),this.list._all_items=i.clone(this.list.items),this.list.search(t,!0)},n.prototype.clear=function(){var t;return i.debug("clear list"),this.list.clear(),null!=(t=this.list.scroll_end)?t.disable():void 0},n.prototype.index=function(t){var e,n,i;return null==(null!=(e=t.pagination)?e.next_page:void 0)?null!=(n=this.list.scroll_end)&&n.disable():(null!=(i=this.list.scroll_end)?i.enabled:void 0)||this.list.scroll_end.enable(),this.render_list_data(t)},n.prototype.render_list_data=function(){},n}(n.views.Base)}(this)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};!function(t){"use strict";var n,i;return n=t.pi=t.pi||{},i=n.utils,n.CheckBox=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(){return this.input=this.find(".checkbox-input"),(this.options.selected||this.hasClass("is-selected"))&&this.select(),this.on("click",function(t){return function(){return t.toggle_select()}}(this)),n.__super__.initialize.apply(this,arguments)},n.prototype.select=function(){return this.selected?void 0:(this.addClass("is-selected"),this.selected=!0,this.input.value(1),this.trigger("checked"))},n.prototype.deselect=function(){return this.selected?(this.removeClass("is-selected"),this.selected=!1,this.input.value(0),this.trigger("unchecked")):void 0},n.prototype.toggle_select=function(){return this.selected?this.deselect():this.select()},n.prototype.value=function(t){return null==t&&(t=null),this.input.value(t)},n}(n.Base)}(this)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};!function(t){"use strict";var n,i;return n=t.pi=t.pi||{},i=n.utils,n.ConfirmModal=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(){return this.message_cont=this.find(".message"),n.__super__.initialize.apply(this,arguments)},n.prototype.init=function(t,e,n){return this._submit=e,this._cancel=n,this.message_cont.append(t)},n.prototype.clear=function(){return this.message_cont.empty(),this._cancel=null,this._submit=null},n.prototype.cancel=function(){return"function"==typeof this._cancel?this._cancel():void 0},n.prototype.confirm=function(){return"function"==typeof this._submit?this._submit():void 0},n}(n.Base)}(this)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};!function(t){"use strict";var n,i,r;return n=t.pi=t.pi||{},i=n.utils,r="",n.Form=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(){return this.former=new FormerJS(this.node,{serialize:!0,rails:!0}),n.__super__.initialize.apply(this,arguments)},n.prototype.value=function(t){return null==t&&(t=null),null!=t?(this.former.fill(t),this.trigger("form_fill")):this.former.parse()},n.prototype.clear=function(){return this.former.clear(),this.trigger("form_clear")},n}(n.Base)}(this)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};!function(t){"use strict";var n,i;return n=t.pi=t.pi||{},i=n.utils,n.ListFilter=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(){var t;return(t=this.options).plugins||(t.plugins=[]),this.options.plugins.push("selectable"),n.__super__.initialize.apply(this,arguments)},n.prototype.value=function(){var t;return t=this.selected_item(),null!=t?t.type:void 0},n}(n.List)}(this)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};!function(t){"use strict";var n,i;return n=t.pi=t.pi||{},i=n.utils,n.LoadProgress=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.start=function(t){return this.value=0,null!=t&&t.hasOwnProperty("onprogress")?t.onprogress=function(t){return function(e){return i.debug("Progress "+e.lengthComputable+": "+e.loaded+" / "+e.total),e.lengthComputable?t.set(100*e.loaded/e.total|0):void 0}}(this):this.simulate(),this.show()},n.prototype.set=function(t){return this.value=t,this.style({width:""+t+"%"})},n.prototype.simulate=function(){return this._sid=after(200,function(t){return function(){return t.set(t.value+(100-t.value)/2),t.simulate()}}(this))},n.prototype.reset=function(){return this._sid&&clearTimeout(this._sid),this.style({width:0}),this.hide()},n.prototype.stop=function(){return this._sid&&clearTimeout(this._sid),this.style({width:"101%"}),after(200,function(t){return function(){return t.style({width:0}),t.hide()}}(this))},n}(n.Base)}(this)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};!function(t){"use strict";var n,i;return n=t.pi=t.pi||{},i=n.utils,n.Popup=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return e(r,t),r.prototype.resize_handler=function(){return this._resize_handler?this._resize_handler:this._resize_handler=function(t){return function(){var e,i,r;if(t.target)return e=t.target.height(),i=n.Nod.root.height(),r=i>e?(i-e)/2:0,t.target.top(r)}}(this)},r.prototype.open=function(t,e){return this.target=t,this.options=null!=e?e:{},this._is_open?void i.warning("Trying to popup over popup!"):(this.target_parent=this.target.parent(),this.append(this.target),this.show(),this.options.align!==!1&&(after(50,function(t){return function(){return t.resize_handler()()}}(this)),n.NodEvent.add(window,"resize",this.resize_handler())),this.target.addClass("is-popup"),this.target.show(),this._is_open=!0,this.trigger("opened"))},r.prototype.handle_close=function(){if(null==this.options.close)return void this.close();if(this.options.close!==!1)return"function"==typeof this.options.close?this.options.close.call(null):n.str_to_fun(this.options.close)()},r.prototype.close=function(t){return new Promise(function(e){return function(i,r){return e.target||r(Error("popup is empty")),t&&t!==e.target&&r(Error("wrong target")),after(500,function(){return e.target.hide(),e.target.removeClass("is-popup"),e.target_parent.append(e.target),e.target=null,e.target_parent=null,e._is_open=!1,e.options.align!==!1&&n.NodEvent.remove(window,"resize",e.resize_handler()),i()}),e.hide()}}(this)).then(function(t){return function(){return t.trigger("closed")}}(this))},r}(n.Base)}(this)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};!function(t){"use strict";var n,i;return n=t.pi=t.pi||{},i=n.utils,n.SearchInput=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(){return n.__super__.initialize.apply(this,arguments),this.find(".fa").on("click",function(t){return function(){return t.reset()}}(this)),this.input.on("keyup",debounce(300,this._query,this))},n.prototype._query=function(){var t;return this.active||this.activate(),t=this.input.value(),i.debug("query: "+t),this.trigger("query",t),t?void 0:this.deactivate()},n.prototype.reset=function(){return this.value(""),this.deactivate(),this.trigger("query","")},n}(n.TextInput)}(this)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};!function(t){"use strict";var n,i;return n=t.pi=t.pi||{},i=n.utils,n.SelectAll=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.initialize=function(){return n.event.one("piecified",function(t){return function(){return t._attach_list($(""+t.options.list))}}(this)),i.__super__.initialize.apply(this,arguments)},i.prototype._attach_list=function(t){return this.target=t,this.target?this.on("item_click",function(t){return function(e){return t.target[e.data.item.action]()}}(this)):void 0},i}(n.List)}(this)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};!function(t){"use strict";var n,i;return n=t.pi=t.pi||{},i=n.utils,n.SelectInput=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.initialize=function(){return this.input=this.find("select"),this.placeholder=this.find(".selected-placeholder"),null!=this.placeholder&&this.input.on("change",function(t){return function(){return t.trigger("change"),t.update_text()}}(this)),n.Base.prototype.initialize.apply(this),this.update_text()},i.prototype.update_text=function(){return this.placeholder.text(this.input.node.options[this.input.node.selectedIndex].textContent)},i}(n.TextInput)}(this)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};!function(t){"use strict";var n,i;return n=t.pi=t.pi||{},i=n.utils,n.SortButton=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.initialize=function(){return this.state=this.hasClass("is-sort-desc")?"desc":this.hasClass("is-sort-asc")?"asc":"",n.event.one("piecified",function(t){return function(){return t._attach_list($(""+t.options.list))}}(this)),i.__super__.initialize.apply(this,arguments)},i.prototype._attach_list=function(t){return this.list=t,this.list.on("sort_update",function(t){return function(e){return e.data.fields!==t.options.field&&(t.toggle(),e.data.reverse)?t.toggle():void 0}}(this))},i.prototype.toggle=function(){var t;return t=this.state,this.clear(),this.state="desc"===t?(this.addClass("is-sort-asc"),"asc"):(this.addClass("is-sort-desc"),"desc"),this.value()},i.prototype.clear=function(){return"desc"===this.state?this.removeClass("is-sort-desc"):"asc"===this.state&&this.removeClass("is-sort-asc"),this.state=""},i.prototype.value=function(){return{sort_by:this.options.field,order:this.state}},i}(n.Button)}(this)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};!function(t){"use strict";var n,i;return n=t.pi=t.pi||{},i=n.utils,n.StatusMessage=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(){return this.delay=this.options.delay||0,n.__super__.initialize.apply(this,arguments)},n.prototype.show=function(t){return null!=this._tid&&clearTimeout(this._tid),this.text(t),n.__super__.show.apply(this,arguments),after(200,function(t){return function(){return t.activate()}}(this)),this._tid=after(this.delay,function(t){return function(){return t.hide()}}(this))},n.prototype.hide=function(){return clearTimeout(this._tid),this.deactivate(),after(200,function(t){return function(){return n.__super__.hide.apply(t,arguments)}}(this))},n}(n.Base)}(this)}.call(this),function(){!function(t){"use strict";var e,n;return e=t.pi=t.pi||{},n=e.utils,e.Redrawable=function(){function t(t){this.list=t,this.list.redrawable=this,this.list.delegate(["redraw_item"],"redrawable")}return t.prototype.redraw_item=function(t,e){var n,i;n=this.list.items.indexOf(t),n>-1&&(t.nod.detach(),delete t.nod,t=this.list.item_renderer(e),t.nod.data("listIndex",n),this.list.items[n]=t,n<this.list.size()-1?(i=this.list.items[n+1],i.nod.insertBefore(t.nod)):this.list.items_cont.append(t.nod))},t}()}(this)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};!function(t){"use strict";var n,i;return n=t.pi=t.pi||{},i=n.utils,n.SelectableDisabled=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.item_click_handler=function(){return this._item_click_handler?this._item_click_handler:this._item_click_handler=function(t){return function(e){e.data.item.disabled||(t.type.match("radio")&&!e.data.item.selected?(t.list.clear_selection(!0),t.list._select(e.data.item),t.list.trigger("selected")):t.type.match("check")&&(t.list._toggle_select(e.data.item),t.list.trigger(t.list.selected().length?"selected":"selection_cleared")))}}(this)},n.prototype.select_all=function(){var t,e,n,i;for(i=this.items,e=0,n=i.length;n>e;e++)t=i[e],t.disabled||this._select(t);return this.selected().length?this.trigger("selected"):void 0},n.prototype._select=function(t,e){return null==e&&(e=!1),e||!t.disabled?n.__super__._select.apply(this,arguments):void 0},n.prototype._deselect=function(t,e){return null==e&&(e=!1),e||!t.disabled?n.__super__._deselect.apply(this,arguments):void 0},n.prototype.disable_item=function(t){return t.disabled?void 0:(t.disabled=!0,t.nod.addClass("is-disabled"))},n.prototype.enable_item=function(t){return t.disabled?(delete t.disabled,t.nod.removeClass("is-disabled")):void 0},n}(n.Selectable)}(this)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};!function(t){"use strict";var n,i,r;return n=t.jQuery,i=t.pi=t.pi||{},r=i.utils,i.ScrollEndExt=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.enable=function(){return this.enabled?void 0:(n.__super__.enable.apply(this,arguments),this.list.on("update",this.update_listener()))},n.prototype.disable=function(){return this.enabled?(n.__super__.disable.apply(this,arguments),this.list.off("update",this.update_listener())):void 0},n.prototype.update_listener=function(){return null!=this._update_listener?this._update_listener:(this._top=function(t){return function(){return t.scroll_object===t.list.items_cont?0:t.list.offset().y}}(this),this._update_listener=debounce(500,function(t){return function(e){var n;return t.list.scroll_end.enabled&&(null==(null!=(n=e.data)?n.type:void 0)||"item_removed"===e.data.type)&&t.list.height()+t._top()-t.scroll_object.scrollTop()<t.scroll_object.height()?t.list.trigger("scroll_end"):void 0}}(this)))},n}(i.ScrollEnd)}(this)}.call(this),function(){pi.Nod.root.ready(function(){return pi.Nod.root.each(".after-load",function(t){return t.classList.remove("after-load")})})}.call(this),function(){pi.client=new Faye.Client("/faye")}.call(this),function(){var t=null;pi.NodEvent.add(window,"scroll",function(){t&&clearTimeout(t),t=setTimeout(function(){document.body.classList.remove("is-scrolling"),t=null},200),document.body.classList.add("is-scrolling")})}(),function(){pi.Nod.root.ready(function(){var t;return t=$(".main-progress"),null!=t?(t.style({width:"100%"}),after(500,function(){return t.style({opacity:0}),after(500,function(){return t.remove()})})):void 0})}.call(this),function(){var t;window.app=pi._storage.app=pi.app={},t=pi.str_to_fun,pi.str_to_fun=function(e,n){return null==n&&(n=null),"@@"===e.slice(0,2)&&(e="@app.page.context."+e.slice(2)),t(e,n)},pi.Nod.root.ready(function(){return pi.piecify()})}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/golimo"]=function(){return function(t){return null==t&&(t={}),Skim.withContext.call({},t,function(){var t;return t="",t+='<li class="item ',t+=this.escape(this.klass),t+='" data-form="',t+=this.escape(this.form),t+='" data-fullname="',t+=this.escape(this.fullname),t+='" data-id="',t+=this.escape(this.id),t+='" data-last-name="',t+=this.escape(this.last_name),t+='" data-name="',t+=this.escape(this.name),t+='" data-team="',t+=this.escape(this.team),t+='" data-total-tasks="',t+=this.escape(this.total_tasks),t+='"><div class="field name" title="',t+=this.escape(this.fullname),t+='">',t+=this.escape(this.fullname),t+='</div><div class="field form" title="',t+=this.escape(this.form),t+='">',t+=this.escape(this.form),t+='</div><div class="field team" title="',t+=this.escape(this.team),t+='">',t+=this.escape(this.team),t+='</div><div class="field team" title="',t+=this.escape(this.money),t+='">',t+=this.escape(this.money),t+='</div><div class="field team">',t+=this.escape(this.total_tasks),t+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/values"]=function(){return function(t){return null==t&&(t={}),Skim.withContext.call({},t,function(){var t,e,n,i,r,s,o,a;for(e="",e+='<div class="values"><div class="inline team-cont"><div class="title">\u041f\u043e\u043a\u0443\u043f\u043a\u0430',o=this.buy,n=0,r=o.length;r>n;n++)t=o[n],e+='<div class="inline category"><p><span class="cat-title item">',e+=this.escape(t.title),e+='</span><span class="item simple">',e+=this.escape(t.simple),e+='</span><span class="item dif">',e+=this.escape(t.dif),e+="</span></p></div>";for(e+='</div></div><div class="inline team-cont"><div class="title">\u041f\u0440\u043e\u0434\u0430\u0436\u0430',a=this.sell,i=0,s=a.length;s>i;i++)t=a[i],e+='<div class="inline category"><p><span class="cat-title item">',e+=this.escape(t.title),e+='</span><span class="item simple">',e+=this.escape(t.simple),e+='</span><span class="item dif">',e+=this.escape(t.dif),e+="</span></p></div>";return e+="</div></div></div>"})}}.call(this)}.call(this);